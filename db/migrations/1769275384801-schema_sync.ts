import { MigrationInterface, QueryRunner } from "typeorm";

export class SchemaSync1769275384801 implements MigrationInterface {
    name = 'SchemaSync1769275384801'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "locations_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_approved_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_operator_ass_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_process_step_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_schedule_data_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_scheduled_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "time_segments_work_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "work_order_operators_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "work_order_operators_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "work_order_operators_work_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "fk_user_profiles_company"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "user_profiles_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "user_profiles_default_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "user_profiles_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP CONSTRAINT "work_order_statuses_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_disposition_approved_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_inspector_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_process_step_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_rejection_reason_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_resolved_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_work_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "rejection_reasons_category_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "rejection_reasons_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "rejection_reasons_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP CONSTRAINT "rejection_categories_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP CONSTRAINT "rejection_categories_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "system_configurations_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "system_configurations_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "system_configurations_updated_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "fk_schedule_data_schedule_file"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "schedule_data_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "schedule_data_synced_work_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP CONSTRAINT "schedule_files_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP CONSTRAINT "schedule_files_uploaded_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "fk_work_orders_company"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "work_orders_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "work_orders_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "work_orders_status_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "work_orders_status_updated_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "work_order_status_history_changed_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "work_order_status_history_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "work_order_status_history_work_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP CONSTRAINT "department_settings_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP CONSTRAINT "department_settings_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP CONSTRAINT "departments_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "work_order_custom_statuses_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "work_order_custom_statuses_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "work_order_custom_statuses_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "downtime_categories_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "downtime_categories_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "downtime_reasons_category_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "downtime_reasons_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "downtime_reasons_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "work_order_downtime_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "work_order_downtime_downtime_reason_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "work_order_downtime_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "work_order_downtime_work_order_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP CONSTRAINT "shifts_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP CONSTRAINT "operator_departments_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP CONSTRAINT "operator_departments_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "operators_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "operators_default_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "operators_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "process_steps_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "process_steps_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "schedule_operator_assignments_assigned_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "schedule_operator_assignments_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "schedule_operator_assignments_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "schedule_operator_assignments_process_step_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "schedule_operator_assignments_schedule_data_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "schedule_operator_assignments_shift_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP CONSTRAINT "schedule_api_keys_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP CONSTRAINT "schedule_api_keys_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP CONSTRAINT "product_vendors_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP CONSTRAINT "product_vendors_product_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP CONSTRAINT "product_cost_history_changed_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP CONSTRAINT "product_cost_history_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP CONSTRAINT "product_cost_history_product_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "partnumber_info_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "partnumber_info_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP CONSTRAINT "product_pricing_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP CONSTRAINT "product_pricing_product_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP CONSTRAINT "product_categories_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP CONSTRAINT "product_categories_parent_category_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP CONSTRAINT "operator_sessions_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP CONSTRAINT "operator_sessions_operator_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" DROP CONSTRAINT "organization_invitations_created_organization_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "location_statuses_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "location_statuses_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "location_statuses_status_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "location_statuses_updated_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "location_departments_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "location_departments_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "location_departments_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "location_departments_updated_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" DROP CONSTRAINT "email_verification_tokens_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "invitations_invited_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "invitations_location_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "invitations_organization_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "invitations_user_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "department_oee_settings_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "department_oee_settings_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "department_oee_settings_department_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "conditional_status_rules_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "conditional_status_rules_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "conditional_status_rules_status_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP CONSTRAINT "company_column_mappings_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP CONSTRAINT "company_column_mappings_created_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP CONSTRAINT "company_column_mappings_template_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP CONSTRAINT "company_column_mappings_updated_by_fkey"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP CONSTRAINT "column_mapping_history_company_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP CONSTRAINT "column_mapping_history_mapping_id_fkey"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP CONSTRAINT "column_mapping_history_performed_by_fkey"`);
        await queryRunner.query(`DROP INDEX "public"."idx_locations_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_locations_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_work_order_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_start_time"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_shift_date"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_process_step_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_sch_time"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_scheduling"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_operator_scheduled"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_schedule_data"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_process_step"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_time_segments_scheduled_match"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_operators_wo_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_operators_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_operators_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_operators_primary"`);
        await queryRunner.query(`DROP INDEX "public"."idx_user_profiles_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_user_profiles_role"`);
        await queryRunner.query(`DROP INDEX "public"."idx_user_profiles_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_user_profiles_preferences"`);
        await queryRunner.query(`DROP INDEX "public"."idx_unique_company_dept_status_code"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_statuses_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_statuses_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_statuses_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_work_order_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_rejection_reason_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_inspection_date"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_severity"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_process_step_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_shift"`);
        await queryRunner.query(`DROP INDEX "public"."idx_qc_rejections_root_cause_category"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_reasons_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_reasons_category_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_reasons_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_reasons_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."unique_department_reason_code_idx"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_categories_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_categories_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_rejection_categories_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."unique_department_category_code_idx"`);
        await queryRunner.query(`DROP INDEX "public"."idx_system_configurations_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_system_configurations_category"`);
        await queryRunner.query(`DROP INDEX "public"."idx_system_configurations_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_data_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_data_wo_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_data_schedule_file_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_data_import_batch_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_data_data_gin"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_data_raw_data_gin"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_file_name"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_last_sync_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_next_retry_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_auto_sync"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_files_sync_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_slug"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_plan_type"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_stripe_customer_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_stripe_subscription_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_subscription_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_companies_trial_ends_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_location_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_status_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_wo_number"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_product_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_start_time"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_closing_time"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_current_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_release_date"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_orders_company_release_date"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_status_history_wo_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_status_history_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_status_history_changed_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_status_history_status_type"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_status_history_rule"`);
        await queryRunner.query(`DROP INDEX "public"."idx_department_settings_department_name"`);
        await queryRunner.query(`DROP INDEX "public"."idx_departments_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_departments_department_name"`);
        await queryRunner.query(`DROP INDEX "public"."idx_unique_company_dept_status_name"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_custom_statuses_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_custom_statuses_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_custom_statuses_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_wo_custom_statuses_display_order"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_categories_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_categories_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_categories_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_reasons_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_reasons_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_reasons_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_reasons_category"`);
        await queryRunner.query(`DROP INDEX "public"."idx_downtime_reasons_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_downtime_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_downtime_work_order"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_downtime_start_time"`);
        await queryRunner.query(`DROP INDEX "public"."idx_work_order_downtime_reason"`);
        await queryRunner.query(`DROP INDEX "public"."idx_shifts_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_shifts_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operator_departments_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operator_departments_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operator_departments_is_primary"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_user_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_email"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_password_hash"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operators_must_change_password"`);
        await queryRunner.query(`DROP INDEX "public"."idx_process_steps_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_process_steps_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_process_steps_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_process_steps_company_dept_sequence"`);
        await queryRunner.query(`DROP INDEX "public"."idx_process_steps_attributes"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_operator_assignments_scheduled_time"`);
        await queryRunner.query(`DROP INDEX "public"."idx_soa_schedule_data"`);
        await queryRunner.query(`DROP INDEX "public"."idx_soa_operator"`);
        await queryRunner.query(`DROP INDEX "public"."idx_soa_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_soa_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_api_keys_api_key"`);
        await queryRunner.query(`DROP INDEX "public"."idx_schedule_api_keys_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_vendors_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_vendors_product"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_vendors_primary"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_cost_history_product"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_cost_history_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_info_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_info_location_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_info_department"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_info_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_inventory_type"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_lifecycle_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_abc_classification"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_primary_vendor"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_sku"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_barcode"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_product_category"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_make_or_buy"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_critical_item"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_requires_inspection"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_hazmat"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_purchasable"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_sellable"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_metadata_gin"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_custom_fields_gin"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_tags_gin"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_company_lifecycle"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_company_category"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_company_type"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_info_part_number"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_category_level_1"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_category_level_2"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_category_level_3"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_category_level_4"`);
        await queryRunner.query(`DROP INDEX "public"."idx_partnumber_category_hierarchy"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_pricing_product"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_pricing_tier"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_pricing_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_categories_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_product_categories_parent"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operator_sessions_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operator_sessions_token_hash"`);
        await queryRunner.query(`DROP INDEX "public"."idx_operator_sessions_expires_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_org_invitations_token"`);
        await queryRunner.query(`DROP INDEX "public"."idx_org_invitations_email"`);
        await queryRunner.query(`DROP INDEX "public"."idx_org_invitations_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_statuses_location"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_statuses_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_statuses_visible"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_statuses_sort"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_departments_location"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_departments_department"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_departments_visible"`);
        await queryRunner.query(`DROP INDEX "public"."idx_location_departments_sort"`);
        await queryRunner.query(`DROP INDEX "public"."idx_email_verification_tokens_token"`);
        await queryRunner.query(`DROP INDEX "public"."idx_email_verification_tokens_user_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_email_verification_tokens_expires_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_location_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_organization"`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_expires_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_dept_oee_settings_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_dept_oee_settings_department"`);
        await queryRunner.query(`DROP INDEX "public"."idx_dept_oee_settings_effective_from"`);
        await queryRunner.query(`DROP INDEX "public"."idx_dept_oee_settings_effective_to"`);
        await queryRunner.query(`DROP INDEX "public"."idx_dept_oee_settings_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_conditional_rules_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_conditional_rules_status"`);
        await queryRunner.query(`DROP INDEX "public"."idx_conditional_rules_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_conditional_rules_priority"`);
        await queryRunner.query(`DROP INDEX "public"."idx_unique_rule_name_per_company"`);
        await queryRunner.query(`DROP INDEX "public"."idx_company_column_mappings_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_company_column_mappings_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."idx_company_column_mappings_is_default"`);
        await queryRunner.query(`DROP INDEX "public"."idx_company_column_mappings_template_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_column_mapping_history_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_column_mapping_history_mapping_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_column_mapping_history_action"`);
        await queryRunner.query(`DROP INDEX "public"."idx_column_mapping_history_performed_at"`);
        await queryRunner.query(`DROP INDEX "public"."idx_column_mapping_templates_erp_system"`);
        await queryRunner.query(`DROP INDEX "public"."idx_column_mapping_templates_is_system"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "code_not_empty"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "valid_location_type"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "valid_manager_email"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "valid_country"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "end_after_start"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "valid_segment_type"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "qty_produced_valid"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "qty_rejected_valid"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "at_least_one_primary_per_wo"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "employee_id_not_empty"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "valid_shift"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "valid_role"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP CONSTRAINT "name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP CONSTRAINT "code_not_empty"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "quantity_rejected_positive"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "valid_action_taken"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "qc_rejections_severity_check"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "code_not_empty"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "valid_default_action"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP CONSTRAINT "name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP CONSTRAINT "code_not_empty"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP CONSTRAINT "schedule_files_last_sync_status_check"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "valid_slug"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "slug_length"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "valid_plan_type"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "valid_subscription_status"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "valid_currency"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP CONSTRAINT "valid_time_format"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "wo_number_not_empty"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "wo_qty_positive"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "qty_completed_valid"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "qty_rejected_valid"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "setup_time_valid"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "down_time_valid"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "break_time_valid"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "valid_status_type"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP CONSTRAINT "department_name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "valid_employee_type"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "valid_shift"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "valid_status"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "valid_email"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "check_step_type_values"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_inventory_type"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "product_id_not_empty"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_valuation_method"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_make_or_buy"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_abc_classification"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_lifecycle_status"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_assembly_type"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_inspection_type"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_costs_positive"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_dimensions_positive"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_weight_positive"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_lead_time_positive"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "check_percentages"`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" DROP CONSTRAINT "organization_invitations_status_check"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "valid_availability_goal"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "valid_performance_goal"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "valid_quality_goal"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "valid_oee_goal"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "valid_date_range"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "rule_name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "status_name_not_empty"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "valid_priority"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "department_oee_settings_department_id_daterange_excl"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "unique_company_location_code"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "unique_work_order_operator"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "unique_company_config_key"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "unique_company_wo_id"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "unique_company_wo_number"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP CONSTRAINT "unique_company_department_name"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "downtime_categories_company_id_name_key"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "downtime_categories_company_name_unique"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP CONSTRAINT "unique_operator_department"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "unique_company_operator_id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "unique_company_dept_step_sequence"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP CONSTRAINT "unique_product_vendor"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "unique_company_product_id"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "unique_company_part_number"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP CONSTRAINT "unique_company_category"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "unique_location_status"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "unique_location_department"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "invitations_email_key"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP CONSTRAINT "unique_company_mapping_name"`);
        await queryRunner.query(`COMMENT ON TABLE "locations" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_operators" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "user_profiles" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "system_configurations" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "schedule_data" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "schedule_files" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "companies" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_status_history" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "department_settings" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "departments" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_custom_statuses" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "downtime_categories" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "downtime_reasons" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_downtime" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "operator_departments" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "operators" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "schedule_api_keys" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "operator_sessions" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "location_statuses" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "location_departments" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "email_verification_tokens" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "invitations" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "department_oee_settings" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "conditional_status_rules" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "company_column_mappings" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "column_mapping_history" IS NULL`);
        await queryRunner.query(`COMMENT ON TABLE "column_mapping_templates" IS NULL`);
        await queryRunner.query(`CREATE TABLE "plans" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "created_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "deleted_at" TIMESTAMP WITH TIME ZONE, "created_by" uuid, "code" character varying(50) NOT NULL, "name" character varying(100) NOT NULL, "description" text, "monthly_price" numeric(10,2) NOT NULL DEFAULT '0', "yearly_price" numeric(10,2) NOT NULL DEFAULT '0', "trial_days" integer NOT NULL DEFAULT '0', "features" jsonb NOT NULL DEFAULT '[]', "max_users" integer NOT NULL DEFAULT '5', "max_locations" integer NOT NULL DEFAULT '1', "is_active" boolean NOT NULL DEFAULT true, "is_free_trial" boolean NOT NULL DEFAULT false, "stripe_price_id_monthly" character varying(255), "stripe_price_id_yearly" character varying(255), "sort_order" integer NOT NULL DEFAULT '0', CONSTRAINT "UQ_plans_code" UNIQUE ("code"), CONSTRAINT "PK_plans" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE UNIQUE INDEX "IDX_plans_code" ON "plans" ("code") `);
        await queryRunner.query(`CREATE TYPE "public"."subscriptions_status_enum" AS ENUM('active', 'expired', 'canceled', 'past_due')`);
        await queryRunner.query(`CREATE TYPE "public"."subscriptions_billing_cycle_enum" AS ENUM('monthly', 'yearly')`);
        await queryRunner.query(`CREATE TABLE "subscriptions" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "created_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "deleted_at" TIMESTAMP WITH TIME ZONE, "created_by" uuid, "company_id" uuid NOT NULL, "plan_id" uuid NOT NULL, "status" "public"."subscriptions_status_enum" NOT NULL DEFAULT 'active', "start_date" TIMESTAMP WITH TIME ZONE NOT NULL, "end_date" TIMESTAMP WITH TIME ZONE, "billing_cycle" "public"."subscriptions_billing_cycle_enum" NOT NULL DEFAULT 'monthly', "amount" numeric(10,2) NOT NULL DEFAULT '0', "stripe_subscription_id" character varying(255), "next_billing_date" TIMESTAMP WITH TIME ZONE, "canceled_at" TIMESTAMP WITH TIME ZONE, "companyId" uuid, "planId" uuid, CONSTRAINT "PK_subscriptions" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_subscriptions_status" ON "subscriptions" ("status") `);
        await queryRunner.query(`CREATE INDEX "IDX_subscriptions_company_id" ON "subscriptions" ("company_id") `);
        await queryRunner.query(`CREATE TYPE "public"."transactions_type_enum" AS ENUM('trial_started', 'trial_ended', 'subscription_payment', 'subscription_renewed', 'refund', 'plan_changed')`);
        await queryRunner.query(`CREATE TYPE "public"."transactions_status_enum" AS ENUM('pending', 'succeeded', 'failed')`);
        await queryRunner.query(`CREATE TABLE "transactions" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "created_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "deleted_at" TIMESTAMP WITH TIME ZONE, "created_by" uuid, "company_id" uuid NOT NULL, "subscription_id" uuid, "type" "public"."transactions_type_enum" NOT NULL, "status" "public"."transactions_status_enum" NOT NULL DEFAULT 'pending', "amount" numeric(10,2) NOT NULL DEFAULT '0', "currency" character varying(3) NOT NULL DEFAULT 'USD', "stripe_payment_intent_id" character varying(255), "stripe_invoice_id" character varying(255), "description" text, "metadata" jsonb, "companyId" uuid, "subscriptionId" uuid, CONSTRAINT "PK_transactions" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_transactions_subscription_id" ON "transactions" ("subscription_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_transactions_company_id" ON "transactions" ("company_id") `);
        await queryRunner.query(`CREATE TABLE "activity_log" ("id" character varying NOT NULL, "user_id" uuid, "url" character varying, "resource" character varying, "method" character varying NOT NULL, "status_code" character varying, "req_body" character varying, "user_agent" character varying, "error" jsonb, "client_ip" character varying NOT NULL, "request_time_in_millis" integer, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), CONSTRAINT "PK_activity_log" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE TYPE "public"."webhook_events_status_enum" AS ENUM('received', 'processing', 'completed', 'failed')`);
        await queryRunner.query(`CREATE TABLE "webhook_events" ("id" uuid NOT NULL DEFAULT uuid_generate_v4(), "created_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(), "deleted_at" TIMESTAMP WITH TIME ZONE, "created_by" uuid, "event_id" character varying(255) NOT NULL, "event_type" character varying(100) NOT NULL, "provider" character varying(50) NOT NULL DEFAULT 'stripe', "status" "public"."webhook_events_status_enum" NOT NULL DEFAULT 'received', "payload" jsonb, "metadata" jsonb, "error_message" text, "processing_attempts" integer NOT NULL DEFAULT '0', "processed_at" TIMESTAMP WITH TIME ZONE, CONSTRAINT "UQ_webhook_events_event_id" UNIQUE ("event_id"), CONSTRAINT "PK_webhook_events" PRIMARY KEY ("id"))`);
        await queryRunner.query(`CREATE INDEX "IDX_webhook_events_created_at" ON "webhook_events" ("created_at") `);
        await queryRunner.query(`CREATE INDEX "IDX_webhook_events_status" ON "webhook_events" ("status") `);
        await queryRunner.query(`CREATE INDEX "IDX_webhook_events_event_type" ON "webhook_events" ("event_type") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "IDX_webhook_events_event_id" ON "webhook_events" ("event_id") `);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "process_step_id"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "is_scheduled"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "schedule_notes"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "scheduled_by"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "scheduled_date"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "schedule_data_id"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "status"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "sch_time"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "step_config"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "step_availability"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "step_performance"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "step_quality"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "step_oee"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "default_location_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "font_color"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "border_color"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "is_flashing"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "flash_interval_ms"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "status_type"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "font_weight"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "data"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "file_hash"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "last_sync_status"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "last_sync_error"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "sync_retry_count"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "next_retry_at"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "email_notifications"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "automatic_backups"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "zip_code"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "part_number"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "run_sequence_1"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "run_sequence_2"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "cycle_time_uom"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "category_level_1"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "category_level_2"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "category_level_3"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "category_level_4"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "organization_id"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "user_id"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "description"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "source_type"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "template_id"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "required_columns"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "validation_rules"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "error_count"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "updated_by"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "description" text`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "email" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "downtime_reason_id" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "workOrderId" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "operatorId" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "operatorAssId" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "approvedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD "workOrderId" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD "operatorId" uuid`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "location_id" uuid`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "email" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "UQ_user_profiles_email" UNIQUE ("email")`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "is_verified" boolean NOT NULL DEFAULT false`);
        await queryRunner.query(`CREATE TYPE "public"."user_profiles_roles_enum" AS ENUM('company_admin', 'user', 'operator', 'location_admin', 'admin', 'super_admin')`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "roles" "public"."user_profiles_roles_enum" array NOT NULL DEFAULT '{operator}'`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "avatar_url" text`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "password" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "locationId" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "workOrderId" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "rejectionReasonId" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "inspectorId" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "resolvedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "operatorId" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "dispositionApprovedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD "categoryId" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD "createdBy" uuid`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD "updatedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "wo_number" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "release_date" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "sequence" integer NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "due_date" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "status" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "part_number" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "department" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "qty_open" integer NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "prod_date" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "bulk_lot" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "prod_qty" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "insp_qty" integer NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "rejected" integer NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "shift" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "scheduleFileId" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "syncedWorkOrderId" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "uploadedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "subscription_tier" character varying(50) NOT NULL DEFAULT 'free'`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "max_users" integer NOT NULL DEFAULT '5'`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "max_locations" integer NOT NULL DEFAULT '1'`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "has_used_free_trial" boolean NOT NULL DEFAULT false`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD "locationId" uuid`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD "statusId" uuid`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD "statusUpdatedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "departments" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "departments" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD "productId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD "productId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD "changedBy" uuid`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "product_id" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "run_sequence1" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "run_sequence2" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "locationId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD "productId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD "parentCategoryId" uuid`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "full_name" character varying`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "custom_message" character varying`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "company_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "companyId" uuid`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "created_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD "deleted_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD "created_by" uuid`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "location_type"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "location_type" character varying NOT NULL DEFAULT 'manufacturing'`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "manager_name"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "manager_name" character varying`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "manager_email"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "manager_email" character varying`);
        await queryRunner.query(`COMMENT ON COLUMN "locations"."operating_hours" IS NULL`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "production_lines" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "country"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "country" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "work_order_id" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "operator_id" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "time_segments"."operator_id" IS NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "start_time" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "time_segments"."start_time" IS NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "segment_type" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "qty_produced" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "qty_rejected" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "is_approved" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "is_primary" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_operators"."is_primary" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "assigned_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_operators"."assigned_at" IS NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "id" SET DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "company_id" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "display_name"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "display_name" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "employee_id"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "employee_id" character varying(100)`);
        await queryRunner.query(`COMMENT ON COLUMN "user_profiles"."role" IS NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "role" DROP DEFAULT`);
        await queryRunner.query(`COMMENT ON COLUMN "user_profiles"."permissions" IS NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "shift_preference"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "shift_preference" character varying(50)`);
        await queryRunner.query(`COMMENT ON COLUMN "user_profiles"."preferences" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "is_default" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "is_terminal" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "can_edit_wo" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "requires_approval" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "display_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "inspection_date" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "severity" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "qc_rejections"."severity" IS NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "cost_currency" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "qc_rejections"."root_cause_category" IS NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "process_step_id"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "process_step_id" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "equipment_id"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "equipment_id" uuid`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "customer_complaint_related" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "attributes" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "qc_rejections"."attributes" IS NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD "department_id" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "requires_photo" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "requires_comment" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "requires_approval" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "display_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD "department_id" uuid`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "requires_rework" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "requires_scrap" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "display_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."config_key" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."config_value" IS NULL`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "config_type" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."config_type" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."category" IS NULL`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_data"."raw_data" IS NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "raw_data" DROP DEFAULT`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "is_synced" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "source_type" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_files"."source_type" IS NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "sync_frequency" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_files"."sync_frequency" IS NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "auto_sync_enabled" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "publish_to_schedule_page" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_files"."is_active" IS NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "companies"."slug" IS NULL`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "industry"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "industry" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "city"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "city" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "country"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "country" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "timezone" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "timezone" SET DEFAULT 'America/Toronto'`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "subscription_status" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "plan_type" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "companies"."plan_type" IS NULL`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "state_province"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "state_province" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "currency"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "currency" character varying NOT NULL DEFAULT 'USD'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "date_format"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "date_format" character varying NOT NULL DEFAULT 'MM/DD/YYYY'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "time_format"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "time_format" character varying NOT NULL DEFAULT '12h'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "language"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "language" character varying NOT NULL DEFAULT 'en'`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "onboarding_completed" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "subscription_cancel_at_period_end" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "stripe_customer_id"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "stripe_customer_id" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "setup_time" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "qty_completed" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "qty_rejected" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "manual_run" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "down_time" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "break_time" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."operator_comment" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."lead_hand_comment" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "current_status" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."current_status" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "status_updated_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."status_updated_at" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."status_updated_by" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."availability_goal" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."performance_goal" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."quality_goal" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."oee_goal" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."release_date" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "old_status"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "old_status" character varying`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "new_status"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "new_status" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "status_type"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "status_type" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "condition_rule_name"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "condition_rule_name" character varying`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_status_history"."matched_conditions" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "change_source"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "change_source" character varying`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_status_history"."work_order_state" IS NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP CONSTRAINT "department_settings_pkey"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD CONSTRAINT "PK_department_settings" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`DROP INDEX "public"."idx_department_settings_department_id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "department_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "department_name" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "display_name" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "filter_table"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "filter_table" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "filter_column"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "filter_column" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "filter_operator"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "filter_operator" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "filter_value" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "department_settings"."filter_value" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "department_settings"."filter_rules" IS NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "sort_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "enable_process_steps" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" DROP CONSTRAINT "departments_pkey"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "departments" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "departments" ADD CONSTRAINT "PK_departments" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "sort_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "department_id" uuid`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "name"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "name" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "color"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "color" character varying(50) NOT NULL DEFAULT '#6B7280'`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "display_order" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_custom_statuses"."display_order" IS NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "downtime_categories_pkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "PK_downtime_categories" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "department_id" uuid`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "downtime_reasons_pkey"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "PK_downtime_reasons" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "category_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "category_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "department_id" uuid`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ALTER COLUMN "display_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP COLUMN "downtime_reason_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD "downtime_reason_id" uuid`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP CONSTRAINT "shifts_pkey"`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD CONSTRAINT "PK_shifts" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "name"`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "name" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "display_name"`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "display_name" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD "department_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ALTER COLUMN "is_primary" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operator_departments"."is_primary" IS NULL`);
        await queryRunner.query(`ALTER TABLE "operators" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."user_id" IS NULL`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "operator_id"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "operator_id" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "first_name"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "first_name" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "last_name"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "last_name" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "shift"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "shift" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "status"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "status" character varying(50) NOT NULL DEFAULT 'active'`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."password_hash" IS NULL`);
        await queryRunner.query(`ALTER TABLE "operators" ALTER COLUMN "must_change_password" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."must_change_password" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."last_login_at" IS NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "process_steps_pkey"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "PK_process_steps" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "department_id" uuid`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "attributes" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "is_required" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "step_type"`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "step_type" character varying NOT NULL DEFAULT 'required'`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."oee_enabled" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."downtime_enabled" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."qty_required_on_close" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."is_last_step" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."is_primary_production_step" IS NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "shift_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "shift_id" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "process_step_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "process_step_id" uuid`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "status"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "status" character varying NOT NULL DEFAULT 'scheduled'`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_operator_assignments"."scheduled_start_time" IS NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP CONSTRAINT "schedule_api_keys_api_key_key"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP COLUMN "api_key"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD "api_key" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD CONSTRAINT "UQ_schedule_api_keys_api_key" UNIQUE ("api_key")`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP COLUMN "name"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD "name" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "is_primary" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."ideal_cycle_time" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."inventory_type" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "valuation_method" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."valuation_method" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "standard_cost" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "currency_code" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "lead_time_days" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."lead_time_days" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "reorder_point" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."reorder_point" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "safety_stock" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."safety_stock" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "minimum_order_qty" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "lot_size_multiple" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."economic_order_qty" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "make_or_buy" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."make_or_buy" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "track_serial_numbers" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."track_serial_numbers" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "track_lot_numbers" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."track_lot_numbers" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "track_expiration" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "abc_classification" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."abc_classification" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "critical_item" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "hazmat" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."hazmat" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "dimension_uom" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "weight_uom" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "volume_uom" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "requires_inspection" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."requires_inspection" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "scrap_percentage" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."scrap_percentage" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "yield_percentage" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."yield_percentage" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "changeover_time" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "bom_level" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."bom_level" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "has_bom" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "bom_component_count" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "phantom_assembly" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "lifecycle_status" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."lifecycle_status" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "metadata" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."metadata" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "custom_fields" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "regulatory_compliance" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."regulatory_compliance" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "alternate_work_centers" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "operation_sequence" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "tags" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."tags" IS NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "purchasable" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "sellable" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "discontinued" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "internal_use_only" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "min_quantity" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "currency_code" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "display_order" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ALTER COLUMN "last_activity_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "location_statuses_pkey"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "PK_location_statuses" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "is_visible" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_statuses"."is_visible" IS NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "sort_order" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_statuses"."sort_order" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_statuses"."location_display_name" IS NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "location_departments_pkey"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD "id" uuid NOT NULL DEFAULT uuid_generate_v4()`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "PK_location_departments" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD "department_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "is_visible" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_departments"."is_visible" IS NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "sort_order" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_departments"."sort_order" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_departments"."location_display_name" IS NULL`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ALTER COLUMN "verified" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "invitations" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "role"`);
        await queryRunner.query(`CREATE TYPE "public"."invitations_role_enum" AS ENUM('company_admin', 'user', 'operator', 'location_admin', 'admin', 'super_admin')`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "role" "public"."invitations_role_enum" DEFAULT 'operator'`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_token"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "invitations_token_key"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "token"`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "token" text NOT NULL`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "UQ_invitations_token" UNIQUE ("token")`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "status"`);
        await queryRunner.query(`CREATE TYPE "public"."invitations_status_enum" AS ENUM('pending', 'accepted', 'rejected')`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "status" "public"."invitations_status_enum" NOT NULL DEFAULT 'pending'`);
        await queryRunner.query(`COMMENT ON COLUMN "invitations"."expires_at" IS NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD "department_id" uuid NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "availability_goal" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "availability_goal" SET DEFAULT '85'`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "performance_goal" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "performance_goal" SET DEFAULT '90'`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "quality_goal" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "quality_goal" SET DEFAULT '95'`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "oee_goal" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "department_oee_settings"."oee_goal" IS NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "oee_goal" SET DEFAULT '72.67'`);
        await queryRunner.query(`COMMENT ON COLUMN "department_oee_settings"."effective_from" IS NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "department_oee_settings"."effective_to" IS NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "rule_name"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "rule_name" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "priority" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."priority" IS NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "status_name"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "status_name" character varying(255) NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."conditions" IS NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "actions" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."actions" IS NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "run_on_import" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."run_on_import" IS NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "run_on_update" SET NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."run_on_update" IS NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "run_on_schedule" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "schedule_cron"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "schedule_cron" character varying`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "execution_count" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "mapping_name"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "mapping_name" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "normalization_rules" DROP DEFAULT`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "mapping_config" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "company_column_mappings"."mapping_config" IS NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "is_active" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "is_default" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "success_count" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "action"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "action" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "source_file_name"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "source_file_name" character varying`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "rows_processed" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "rows_succeeded" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "rows_failed" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "performed_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ALTER COLUMN "created_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ALTER COLUMN "updated_at" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP CONSTRAINT "column_mapping_templates_template_name_key"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP COLUMN "template_name"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD "template_name" character varying NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD CONSTRAINT "UQ_column_mapping_templates_template_name" UNIQUE ("template_name")`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP COLUMN "erp_system"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD "erp_system" character varying`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ALTER COLUMN "is_system_template" SET NOT NULL`);
        await queryRunner.query(`CREATE INDEX "IDX_locations_company_id" ON "locations" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_time_segments_is_active" ON "time_segments" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_time_segments_shift_date" ON "time_segments" ("shift_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_time_segments_start_time" ON "time_segments" ("start_time") `);
        await queryRunner.query(`CREATE INDEX "IDX_time_segments_operator_id" ON "time_segments" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_time_segments_work_order_id" ON "time_segments" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_time_segments_company_id" ON "time_segments" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_operators_work_order_id_is_primary" ON "work_order_operators" ("work_order_id", "is_primary") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_operators_operator_id" ON "work_order_operators" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_operators_work_order_id" ON "work_order_operators" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_operators_company_id" ON "work_order_operators" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_user_profiles_email" ON "user_profiles" ("email") `);
        await queryRunner.query(`CREATE INDEX "IDX_user_profiles_location_id" ON "user_profiles" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_user_profiles_company_id" ON "user_profiles" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_statuses_is_active" ON "work_order_statuses" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_statuses_department_id" ON "work_order_statuses" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_order_statuses_company_id" ON "work_order_statuses" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_root_cause_category" ON "qc_rejections" ("root_cause_category") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_shift" ON "qc_rejections" ("shift") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_operator_id" ON "qc_rejections" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_process_step_id" ON "qc_rejections" ("process_step_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_severity" ON "qc_rejections" ("severity") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_inspection_date" ON "qc_rejections" ("inspection_date") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_rejection_reason_id" ON "qc_rejections" ("rejection_reason_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_work_order_id" ON "qc_rejections" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_qc_rejections_company_id" ON "qc_rejections" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_reasons_is_active" ON "rejection_reasons" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_reasons_category_id" ON "rejection_reasons" ("category_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_reasons_department_id" ON "rejection_reasons" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_reasons_company_id" ON "rejection_reasons" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_categories_is_active" ON "rejection_categories" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_categories_department_id" ON "rejection_categories" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_rejection_categories_company_id" ON "rejection_categories" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_system_configurations_is_active" ON "system_configurations" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_system_configurations_category" ON "system_configurations" ("category") `);
        await queryRunner.query(`CREATE INDEX "IDX_system_configurations_company_id" ON "system_configurations" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_data_import_batch_id" ON "schedule_data" ("import_batch_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_data_schedule_file_id" ON "schedule_data" ("schedule_file_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_data_status" ON "schedule_data" ("status") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_data_department" ON "schedule_data" ("department") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_data_wo_id" ON "schedule_data" ("wo_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_data_company_id" ON "schedule_data" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_files_file_name" ON "schedule_files" ("file_name") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_files_is_active" ON "schedule_files" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_schedule_files_company_id" ON "schedule_files" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_companies_slug" ON "companies" ("slug") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_closing_time" ON "work_orders" ("closing_time") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_start_time" ON "work_orders" ("start_time") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_product_id" ON "work_orders" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_wo_number" ON "work_orders" ("wo_number") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_current_status" ON "work_orders" ("current_status") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_status_id" ON "work_orders" ("status_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_department_id" ON "work_orders" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_location_id" ON "work_orders" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_work_orders_company_id" ON "work_orders" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_department_settings_department_id" ON "department_settings" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_vendors_product_id" ON "product_vendors" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_vendors_company_id" ON "product_vendors" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_cost_history_company_id" ON "product_cost_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_cost_history_product_id" ON "product_cost_history" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_company_id_inventory_type" ON "partnumber_info" ("company_id", "inventory_type") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_company_id_product_category" ON "partnumber_info" ("company_id", "product_category") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_company_id_lifecycle_status" ON "partnumber_info" ("company_id", "lifecycle_status") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_make_or_buy" ON "partnumber_info" ("make_or_buy") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_product_category" ON "partnumber_info" ("product_category") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_barcode" ON "partnumber_info" ("barcode") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_sku" ON "partnumber_info" ("sku") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_primary_vendor_id" ON "partnumber_info" ("primary_vendor_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_abc_classification" ON "partnumber_info" ("abc_classification") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_lifecycle_status" ON "partnumber_info" ("lifecycle_status") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_inventory_type" ON "partnumber_info" ("inventory_type") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_is_active" ON "partnumber_info" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_department" ON "partnumber_info" ("department") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_product_id" ON "partnumber_info" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_location_id" ON "partnumber_info" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_partnumber_info_company_id" ON "partnumber_info" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_pricing_price_tier" ON "product_pricing" ("price_tier") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_pricing_product_id" ON "product_pricing" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_categories_parent_category_id" ON "product_categories" ("parent_category_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_product_categories_company_id" ON "product_categories" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_invitations_token" ON "invitations" ("token") `);
        await queryRunner.query(`CREATE INDEX "idx_invitations_company_id" ON "invitations" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "IDX_company_column_mappings_is_default" ON "company_column_mappings" ("is_default") `);
        await queryRunner.query(`CREATE INDEX "IDX_company_column_mappings_is_active" ON "company_column_mappings" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "IDX_company_column_mappings_company_id" ON "company_column_mappings" ("company_id") `);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "UQ_locations_company_id_code" UNIQUE ("company_id", "code")`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "UQ_work_order_operators_work_order_id_operator_id" UNIQUE ("work_order_id", "operator_id")`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD CONSTRAINT "UQ_work_order_statuses_company_id_department_id_code" UNIQUE ("company_id", "department_id", "code")`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "UQ_system_configurations_company_id_config_key" UNIQUE ("company_id", "config_key")`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "UQ_schedule_data_company_id_wo_id" UNIQUE ("company_id", "wo_id")`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "UQ_work_orders_company_id_wo_number" UNIQUE ("company_id", "wo_number")`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "UQ_partnumber_info_company_id_product_id" UNIQUE ("company_id", "product_id")`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD CONSTRAINT "UQ_product_categories_company_id_category_name" UNIQUE ("company_id", "category_name")`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "FK_locations_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "FK_time_segments_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "FK_time_segments_work_orders_workOrderId" FOREIGN KEY ("workOrderId") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "FK_time_segments_user_profiles_operatorId" FOREIGN KEY ("operatorId") REFERENCES "user_profiles"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "FK_time_segments_user_profiles_operatorAssId" FOREIGN KEY ("operatorAssId") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "FK_time_segments_user_profiles_approvedBy" FOREIGN KEY ("approvedBy") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "FK_work_order_operators_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "FK_work_order_operators_work_orders_workOrderId" FOREIGN KEY ("workOrderId") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "FK_work_order_operators_user_profiles_operatorId" FOREIGN KEY ("operatorId") REFERENCES "user_profiles"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "FK_user_profiles_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "FK_user_profiles_locations_locationId" FOREIGN KEY ("locationId") REFERENCES "locations"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD CONSTRAINT "FK_work_order_statuses_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_work_orders_workOrderId" FOREIGN KEY ("workOrderId") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_rejection_reasons_rejectionReasonId" FOREIGN KEY ("rejectionReasonId") REFERENCES "rejection_reasons"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_user_profiles_inspectorId" FOREIGN KEY ("inspectorId") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_user_profiles_resolvedBy" FOREIGN KEY ("resolvedBy") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_user_profiles_operatorId" FOREIGN KEY ("operatorId") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "FK_qc_rejections_user_profiles_dispositionApprovedBy" FOREIGN KEY ("dispositionApprovedBy") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "FK_rejection_reasons_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "FK_rejection_reasons_rejection_categories_categoryId" FOREIGN KEY ("categoryId") REFERENCES "rejection_categories"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD CONSTRAINT "FK_rejection_categories_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "FK_system_configurations_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "FK_system_configurations_user_profiles_createdBy" FOREIGN KEY ("createdBy") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "FK_system_configurations_user_profiles_updatedBy" FOREIGN KEY ("updatedBy") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "FK_schedule_data_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "FK_schedule_data_schedule_files_scheduleFileId" FOREIGN KEY ("scheduleFileId") REFERENCES "schedule_files"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "FK_schedule_data_work_orders_syncedWorkOrderId" FOREIGN KEY ("syncedWorkOrderId") REFERENCES "work_orders"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD CONSTRAINT "FK_schedule_files_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD CONSTRAINT "FK_schedule_files_user_profiles_uploadedBy" FOREIGN KEY ("uploadedBy") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "subscriptions" ADD CONSTRAINT "FK_subscriptions_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "subscriptions" ADD CONSTRAINT "FK_subscriptions_plans_planId" FOREIGN KEY ("planId") REFERENCES "plans"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactions" ADD CONSTRAINT "FK_transactions_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "transactions" ADD CONSTRAINT "FK_transactions_subscriptions_subscriptionId" FOREIGN KEY ("subscriptionId") REFERENCES "subscriptions"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "FK_work_orders_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "FK_work_orders_locations_locationId" FOREIGN KEY ("locationId") REFERENCES "locations"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "FK_work_orders_work_order_statuses_statusId" FOREIGN KEY ("statusId") REFERENCES "work_order_statuses"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "FK_work_orders_user_profiles_statusUpdatedBy" FOREIGN KEY ("statusUpdatedBy") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "FK_work_order_status_history_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "FK_work_order_status_history_work_orders_work_order_id" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "FK_work_order_status_history_user_profiles_changed_by" FOREIGN KEY ("changed_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD CONSTRAINT "FK_department_settings_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD CONSTRAINT "FK_department_settings_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "departments" ADD CONSTRAINT "FK_departments_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "FK_work_order_custom_statuses_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "FK_work_order_custom_statuses_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "FK_work_order_custom_statuses_user_profiles_created_by" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "FK_downtime_categories_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "FK_downtime_categories_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "FK_downtime_reasons_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "FK_downtime_reasons_downtime_categories_category_id" FOREIGN KEY ("category_id") REFERENCES "downtime_categories"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "FK_downtime_reasons_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "FK_work_order_downtime_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "FK_work_order_downtime_work_orders_work_order_id" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "FK_work_order_downtime_downtime_reasons_downtime_reason_id" FOREIGN KEY ("downtime_reason_id") REFERENCES "downtime_reasons"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "FK_work_order_downtime_user_profiles_operator_id" FOREIGN KEY ("operator_id") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD CONSTRAINT "FK_shifts_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD CONSTRAINT "FK_operator_departments_operators_operator_id" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD CONSTRAINT "FK_operator_departments_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "FK_operators_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "FK_operators_user_profiles_user_id" FOREIGN KEY ("user_id") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "FK_operators_locations_default_location_id" FOREIGN KEY ("default_location_id") REFERENCES "locations"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "FK_process_steps_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "FK_process_steps_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "FK_schedule_operator_assignments_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "FK_schedule_operator_assignments_schedule_data_schedule_data_id" FOREIGN KEY ("schedule_data_id") REFERENCES "schedule_data"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "FK_schedule_operator_assignments_operators_operator_id" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "FK_schedule_operator_assignments_shifts_shift_id" FOREIGN KEY ("shift_id") REFERENCES "shifts"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "FK_schedule_operator_assignments_process_steps_process_step_id" FOREIGN KEY ("process_step_id") REFERENCES "process_steps"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "FK_schedule_operator_assignments_user_profiles_assigned_by" FOREIGN KEY ("assigned_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD CONSTRAINT "FK_schedule_api_keys_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD CONSTRAINT "FK_schedule_api_keys_user_profiles_created_by" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD CONSTRAINT "FK_product_vendors_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD CONSTRAINT "FK_product_vendors_partnumber_info_productId" FOREIGN KEY ("productId") REFERENCES "partnumber_info"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD CONSTRAINT "FK_product_cost_history_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD CONSTRAINT "FK_product_cost_history_partnumber_info_productId" FOREIGN KEY ("productId") REFERENCES "partnumber_info"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD CONSTRAINT "FK_product_cost_history_user_profiles_changedBy" FOREIGN KEY ("changedBy") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "FK_partnumber_info_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "FK_partnumber_info_locations_locationId" FOREIGN KEY ("locationId") REFERENCES "locations"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD CONSTRAINT "FK_product_pricing_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD CONSTRAINT "FK_product_pricing_partnumber_info_productId" FOREIGN KEY ("productId") REFERENCES "partnumber_info"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD CONSTRAINT "FK_product_categories_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD CONSTRAINT "FK_product_categories_product_categories_parentCategoryId" FOREIGN KEY ("parentCategoryId") REFERENCES "product_categories"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD CONSTRAINT "FK_operator_sessions_operators_operator_id" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD CONSTRAINT "FK_operator_sessions_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ADD CONSTRAINT "FK_organization_invitations_companies_created_organization_id" FOREIGN KEY ("created_organization_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "FK_location_statuses_locations_location_id" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "FK_location_statuses_work_order_statuses_status_id" FOREIGN KEY ("status_id") REFERENCES "work_order_statuses"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "FK_location_statuses_user_profiles_created_by" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "FK_location_statuses_user_profiles_updated_by" FOREIGN KEY ("updated_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "FK_location_departments_locations_location_id" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "FK_location_departments_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "FK_location_departments_user_profiles_created_by" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "FK_location_departments_user_profiles_updated_by" FOREIGN KEY ("updated_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "FK_invitations_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "FK_invitations_user_profiles_invited_by" FOREIGN KEY ("invited_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "FK_department_oee_settings_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "FK_department_oee_settings_departments_department_id" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "FK_department_oee_settings_user_profiles_created_by" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "FK_conditional_status_rules_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "FK_conditional_status_rules_work_order_statuses_status_id" FOREIGN KEY ("status_id") REFERENCES "work_order_statuses"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "FK_conditional_status_rules_user_profiles_created_by" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD CONSTRAINT "FK_company_column_mappings_companies_companyId" FOREIGN KEY ("companyId") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD CONSTRAINT "FK_column_mapping_history_companies_company_id" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD CONSTRAINT "FK_column_mapping_history_company_column_mappings_mapping_id" FOREIGN KEY ("mapping_id") REFERENCES "company_column_mappings"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD CONSTRAINT "FK_column_mapping_history_user_profiles_performed_by" FOREIGN KEY ("performed_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP CONSTRAINT "FK_column_mapping_history_user_profiles_performed_by"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP CONSTRAINT "FK_column_mapping_history_company_column_mappings_mapping_id"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP CONSTRAINT "FK_column_mapping_history_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP CONSTRAINT "FK_company_column_mappings_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "FK_conditional_status_rules_user_profiles_created_by"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "FK_conditional_status_rules_work_order_statuses_status_id"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP CONSTRAINT "FK_conditional_status_rules_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "FK_department_oee_settings_user_profiles_created_by"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "FK_department_oee_settings_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP CONSTRAINT "FK_department_oee_settings_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "FK_invitations_user_profiles_invited_by"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "FK_invitations_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "FK_location_departments_user_profiles_updated_by"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "FK_location_departments_user_profiles_created_by"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "FK_location_departments_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "FK_location_departments_locations_location_id"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "FK_location_statuses_user_profiles_updated_by"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "FK_location_statuses_user_profiles_created_by"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "FK_location_statuses_work_order_statuses_status_id"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "FK_location_statuses_locations_location_id"`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" DROP CONSTRAINT "FK_organization_invitations_companies_created_organization_id"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP CONSTRAINT "FK_operator_sessions_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP CONSTRAINT "FK_operator_sessions_operators_operator_id"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP CONSTRAINT "FK_product_categories_product_categories_parentCategoryId"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP CONSTRAINT "FK_product_categories_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP CONSTRAINT "FK_product_pricing_partnumber_info_productId"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP CONSTRAINT "FK_product_pricing_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "FK_partnumber_info_locations_locationId"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "FK_partnumber_info_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP CONSTRAINT "FK_product_cost_history_user_profiles_changedBy"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP CONSTRAINT "FK_product_cost_history_partnumber_info_productId"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP CONSTRAINT "FK_product_cost_history_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP CONSTRAINT "FK_product_vendors_partnumber_info_productId"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP CONSTRAINT "FK_product_vendors_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP CONSTRAINT "FK_schedule_api_keys_user_profiles_created_by"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP CONSTRAINT "FK_schedule_api_keys_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "FK_schedule_operator_assignments_user_profiles_assigned_by"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "FK_schedule_operator_assignments_process_steps_process_step_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "FK_schedule_operator_assignments_shifts_shift_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "FK_schedule_operator_assignments_operators_operator_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "FK_schedule_operator_assignments_schedule_data_schedule_data_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP CONSTRAINT "FK_schedule_operator_assignments_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "FK_process_steps_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "FK_process_steps_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "FK_operators_locations_default_location_id"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "FK_operators_user_profiles_user_id"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP CONSTRAINT "FK_operators_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP CONSTRAINT "FK_operator_departments_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP CONSTRAINT "FK_operator_departments_operators_operator_id"`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP CONSTRAINT "FK_shifts_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "FK_work_order_downtime_user_profiles_operator_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "FK_work_order_downtime_downtime_reasons_downtime_reason_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "FK_work_order_downtime_work_orders_work_order_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP CONSTRAINT "FK_work_order_downtime_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "FK_downtime_reasons_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "FK_downtime_reasons_downtime_categories_category_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "FK_downtime_reasons_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "FK_downtime_categories_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "FK_downtime_categories_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "FK_work_order_custom_statuses_user_profiles_created_by"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "FK_work_order_custom_statuses_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP CONSTRAINT "FK_work_order_custom_statuses_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP CONSTRAINT "FK_departments_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP CONSTRAINT "FK_department_settings_departments_department_id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP CONSTRAINT "FK_department_settings_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "FK_work_order_status_history_user_profiles_changed_by"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "FK_work_order_status_history_work_orders_work_order_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP CONSTRAINT "FK_work_order_status_history_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "FK_work_orders_user_profiles_statusUpdatedBy"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "FK_work_orders_work_order_statuses_statusId"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "FK_work_orders_locations_locationId"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "FK_work_orders_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "transactions" DROP CONSTRAINT "FK_transactions_subscriptions_subscriptionId"`);
        await queryRunner.query(`ALTER TABLE "transactions" DROP CONSTRAINT "FK_transactions_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "subscriptions" DROP CONSTRAINT "FK_subscriptions_plans_planId"`);
        await queryRunner.query(`ALTER TABLE "subscriptions" DROP CONSTRAINT "FK_subscriptions_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP CONSTRAINT "FK_schedule_files_user_profiles_uploadedBy"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP CONSTRAINT "FK_schedule_files_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "FK_schedule_data_work_orders_syncedWorkOrderId"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "FK_schedule_data_schedule_files_scheduleFileId"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "FK_schedule_data_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "FK_system_configurations_user_profiles_updatedBy"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "FK_system_configurations_user_profiles_createdBy"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "FK_system_configurations_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP CONSTRAINT "FK_rejection_categories_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "FK_rejection_reasons_rejection_categories_categoryId"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP CONSTRAINT "FK_rejection_reasons_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_user_profiles_dispositionApprovedBy"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_user_profiles_operatorId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_user_profiles_resolvedBy"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_user_profiles_inspectorId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_rejection_reasons_rejectionReasonId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_work_orders_workOrderId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP CONSTRAINT "FK_qc_rejections_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP CONSTRAINT "FK_work_order_statuses_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "FK_user_profiles_locations_locationId"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "FK_user_profiles_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "FK_work_order_operators_user_profiles_operatorId"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "FK_work_order_operators_work_orders_workOrderId"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "FK_work_order_operators_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "FK_time_segments_user_profiles_approvedBy"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "FK_time_segments_user_profiles_operatorAssId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "FK_time_segments_user_profiles_operatorId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "FK_time_segments_work_orders_workOrderId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP CONSTRAINT "FK_time_segments_companies_companyId"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "FK_locations_companies_company_id"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP CONSTRAINT "UQ_product_categories_company_id_category_name"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP CONSTRAINT "UQ_partnumber_info_company_id_product_id"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP CONSTRAINT "UQ_work_orders_company_id_wo_number"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP CONSTRAINT "UQ_schedule_data_company_id_wo_id"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP CONSTRAINT "UQ_system_configurations_company_id_config_key"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP CONSTRAINT "UQ_work_order_statuses_company_id_department_id_code"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP CONSTRAINT "UQ_work_order_operators_work_order_id_operator_id"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP CONSTRAINT "UQ_locations_company_id_code"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_company_column_mappings_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_company_column_mappings_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_company_column_mappings_is_default"`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_invitations_token"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_categories_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_categories_parent_category_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_pricing_product_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_pricing_price_tier"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_location_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_product_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_department"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_inventory_type"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_lifecycle_status"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_abc_classification"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_primary_vendor_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_sku"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_barcode"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_product_category"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_make_or_buy"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_company_id_lifecycle_status"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_company_id_product_category"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_partnumber_info_company_id_inventory_type"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_cost_history_product_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_cost_history_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_vendors_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_product_vendors_product_id"`);
        await queryRunner.query(`DROP INDEX "public"."idx_department_settings_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_location_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_status_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_current_status"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_wo_number"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_product_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_start_time"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_orders_closing_time"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_companies_slug"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_files_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_files_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_files_file_name"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_data_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_data_wo_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_data_department"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_data_status"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_data_schedule_file_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_schedule_data_import_batch_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_system_configurations_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_system_configurations_category"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_system_configurations_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_categories_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_categories_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_categories_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_reasons_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_reasons_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_reasons_category_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_rejection_reasons_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_work_order_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_rejection_reason_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_inspection_date"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_severity"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_process_step_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_shift"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_qc_rejections_root_cause_category"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_statuses_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_statuses_department_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_statuses_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_user_profiles_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_user_profiles_location_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_user_profiles_email"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_operators_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_operators_work_order_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_operators_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_work_order_operators_work_order_id_is_primary"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_time_segments_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_time_segments_work_order_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_time_segments_operator_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_time_segments_start_time"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_time_segments_shift_date"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_time_segments_is_active"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_locations_company_id"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ALTER COLUMN "is_system_template" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP COLUMN "erp_system"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD "erp_system" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP CONSTRAINT "UQ_column_mapping_templates_template_name"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP COLUMN "template_name"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD "template_name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ADD CONSTRAINT "column_mapping_templates_template_name_key" UNIQUE ("template_name")`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "performed_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "rows_failed" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "rows_succeeded" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ALTER COLUMN "rows_processed" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "source_file_name"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "source_file_name" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "action"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD "action" character varying(50) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "success_count" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "is_default" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "company_column_mappings"."mapping_config" IS 'JSON object mapping database columns to source columns with optional transforms'`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "mapping_config" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "normalization_rules" SET DEFAULT '{}'`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "mapping_name"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "mapping_name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "execution_count" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "schedule_cron"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "schedule_cron" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "run_on_schedule" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."run_on_update" IS 'Evaluate this rule when work order is updated'`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "run_on_update" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."run_on_import" IS 'Evaluate this rule when schedule data is imported'`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "run_on_import" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."actions" IS 'JSONB defining actions to take when rule matches (future: notifications, emails, etc.)'`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "actions" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."conditions" IS 'JSONB defining the conditions to match (supports nested AND/OR logic)'`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "status_name"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "status_name" character varying(100) NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "conditional_status_rules"."priority" IS 'Higher values = higher priority (0-1000). First matching rule wins.'`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "priority" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "rule_name"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD "rule_name" character varying(200) NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "department_oee_settings"."effective_to" IS 'Date when these settings expire (NULL = current/active)'`);
        await queryRunner.query(`COMMENT ON COLUMN "department_oee_settings"."effective_from" IS 'Date when these settings become active'`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "oee_goal" SET DEFAULT 72.67`);
        await queryRunner.query(`COMMENT ON COLUMN "department_oee_settings"."oee_goal" IS 'Auto-calculated from component goals: Availability  Performance  Quality'`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "oee_goal" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "quality_goal" SET DEFAULT 95.00`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "quality_goal" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "performance_goal" SET DEFAULT 90.00`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "performance_goal" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "availability_goal" SET DEFAULT 85.00`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "availability_goal" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD "department_id" integer NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "invitations"."expires_at" IS 'Invitation expiry time (default 7 days)'`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "status"`);
        await queryRunner.query(`DROP TYPE "public"."invitations_status_enum"`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "status" character varying(20) DEFAULT 'pending'`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP CONSTRAINT "UQ_invitations_token"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "token"`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "token" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "invitations_token_key" UNIQUE ("token")`);
        await queryRunner.query(`CREATE INDEX "idx_invitations_token" ON "invitations" ("token") `);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "role"`);
        await queryRunner.query(`DROP TYPE "public"."invitations_role_enum"`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "role" character varying(50) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "invitations" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ALTER COLUMN "verified" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_departments"."location_display_name" IS 'Optional: Override department name for this specific location'`);
        await queryRunner.query(`COMMENT ON COLUMN "location_departments"."sort_order" IS 'Display order of departments within this location'`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "sort_order" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_departments"."is_visible" IS 'Whether this department appears in schedules, OEE, and dashboards for this location'`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "is_visible" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD "department_id" integer NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP CONSTRAINT "PK_location_departments"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "location_departments_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`COMMENT ON COLUMN "location_statuses"."location_display_name" IS 'Optional: Override status name for this specific location'`);
        await queryRunner.query(`COMMENT ON COLUMN "location_statuses"."sort_order" IS 'Display order of statuses within this location'`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "sort_order" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "location_statuses"."is_visible" IS 'Whether this status appears in work order dropdowns for this location'`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "is_visible" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP CONSTRAINT "PK_location_statuses"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "location_statuses_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ALTER COLUMN "last_activity_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "display_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_categories" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "currency_code" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "min_quantity" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "internal_use_only" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "discontinued" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "sellable" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "purchasable" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."tags" IS 'JSON array of searchable tags'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "tags" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "operation_sequence" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "alternate_work_centers" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."regulatory_compliance" IS 'JSON: FDA, CE, RoHS, REACH, etc.'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "regulatory_compliance" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "custom_fields" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."metadata" IS 'Flexible JSON storage for custom attributes'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "metadata" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."lifecycle_status" IS 'Product lifecycle: design, prototype, active, mature, phase_out, obsolete'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "lifecycle_status" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "phantom_assembly" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "bom_component_count" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "has_bom" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."bom_level" IS '0=purchased item, 1+=manufactured/assembly level'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "bom_level" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "changeover_time" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."yield_percentage" IS 'Expected production yield percentage'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "yield_percentage" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."scrap_percentage" IS 'Expected scrap rate percentage'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "scrap_percentage" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."requires_inspection" IS 'Quality inspection required'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "requires_inspection" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "volume_uom" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "weight_uom" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "dimension_uom" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."hazmat" IS 'Hazardous material requiring special handling'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "hazmat" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "critical_item" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."abc_classification" IS 'ABC analysis: A=high value, B=medium value, C=low value, D=obsolete'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "abc_classification" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "track_expiration" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."track_lot_numbers" IS 'Enable lot/batch number tracking'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "track_lot_numbers" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."track_serial_numbers" IS 'Enable serial number tracking'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "track_serial_numbers" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."make_or_buy" IS 'Manufacturing strategy: make=manufactured, buy=purchased, both=either'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "make_or_buy" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."economic_order_qty" IS 'Economic Order Quantity (EOQ) calculation'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "lot_size_multiple" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "minimum_order_qty" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."safety_stock" IS 'Minimum safety stock level'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "safety_stock" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."reorder_point" IS 'Inventory level that triggers reorder'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "reorder_point" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."lead_time_days" IS 'Manufacturing or procurement lead time in days'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "lead_time_days" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "currency_code" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "standard_cost" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."valuation_method" IS 'Cost valuation method: fifo, lifo, average, standard'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "valuation_method" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."inventory_type" IS 'Type of inventory item: raw_material, finished_good, work_in_progress, assembly, component, tool, consumable. No default - must be specified explicitly.'`);
        await queryRunner.query(`COMMENT ON COLUMN "partnumber_info"."ideal_cycle_time" IS 'Ideal/target cycle time for production - used in OEE calculation'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "is_primary" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP COLUMN "name"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD "name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP CONSTRAINT "UQ_schedule_api_keys_api_key"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP COLUMN "api_key"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD "api_key" character varying(64) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD CONSTRAINT "schedule_api_keys_api_key_key" UNIQUE ("api_key")`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_operator_assignments"."scheduled_start_time" IS 'Planned start time for this assignment. Separate from time_segments.start_time which is actual start.'`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "status"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "status" character varying(50) NOT NULL DEFAULT 'scheduled'`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "process_step_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "process_step_id" integer`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "shift_id"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD "shift_id" integer`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."is_primary_production_step" IS 'When true, this step''s qty_produced is displayed in schedule cards and reports. Only one step per department should have this set to true.'`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."is_last_step" IS 'If true, completing this step marks the entire work order as completed. Only one step per department should have this flag.'`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."qty_required_on_close" IS 'If true, close dialog requires quantity produced. If false, qty is optional or not applicable.'`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."downtime_enabled" IS 'If true, operators can log downtime during this step. If false, downtime tracking is disabled.'`);
        await queryRunner.query(`COMMENT ON COLUMN "process_steps"."oee_enabled" IS 'If true, step contributes to OEE calculation. If false, only run_time is tracked.'`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "step_type"`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "step_type" character varying(20) NOT NULL DEFAULT 'required'`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "is_required" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "attributes" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "department_id" integer`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP CONSTRAINT "PK_process_steps"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "process_steps_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."last_login_at" IS 'Timestamp of last successful operator login'`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."must_change_password" IS 'True if operator must change password on next login (first login or after admin reset)'`);
        await queryRunner.query(`ALTER TABLE "operators" ALTER COLUMN "must_change_password" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."password_hash" IS 'Bcrypt hash of operator password for login'`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "status"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "status" character varying(20) DEFAULT 'active'`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "shift"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "shift" character varying(20)`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "last_name"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "last_name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "first_name"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "first_name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "operator_id"`);
        await queryRunner.query(`ALTER TABLE "operators" ADD "operator_id" character varying(50) NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operators"."user_id" IS 'Optional FK to auth.users if operator has a login account'`);
        await queryRunner.query(`ALTER TABLE "operators" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operators" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "operator_departments"."is_primary" IS 'Flag indicating the operator primary department (only one per operator)'`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ALTER COLUMN "is_primary" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD "department_id" integer NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "display_name"`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "display_name" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "name"`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP CONSTRAINT "PK_shifts"`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD CONSTRAINT "shifts_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP COLUMN "downtime_reason_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD "downtime_reason_id" integer`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ALTER COLUMN "display_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "department_id" integer`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "category_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "category_id" integer NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP CONSTRAINT "PK_downtime_reasons"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "downtime_reasons_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "department_id" integer`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP CONSTRAINT "PK_downtime_categories"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "downtime_categories_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_custom_statuses"."display_order" IS 'Order in which statuses appear in dropdowns'`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "display_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "color"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "color" character varying(7) DEFAULT '#6B7280'`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "name"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "name" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD "department_id" integer`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "sort_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" DROP CONSTRAINT "PK_departments"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "departments" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "departments" ADD CONSTRAINT "departments_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "enable_process_steps" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "sort_order" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "department_settings"."filter_rules" IS 'JSON string defining complex filter logic'`);
        await queryRunner.query(`COMMENT ON COLUMN "department_settings"."filter_value" IS 'The value to match'`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "filter_value" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "filter_operator"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "filter_operator" character varying(20) DEFAULT '='`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "filter_column"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "filter_column" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "filter_table"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "filter_table" character varying(255) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "display_name" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "department_name" SET NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "department_id" integer`);
        await queryRunner.query(`CREATE INDEX "idx_department_settings_department_id" ON "department_settings" ("department_id") `);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP CONSTRAINT "PK_department_settings"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "id"`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD "id" SERIAL NOT NULL`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD CONSTRAINT "department_settings_pkey" PRIMARY KEY ("id")`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_status_history"."work_order_state" IS 'Snapshot of work order key fields at time of status change'`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "change_source"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "change_source" character varying(50)`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_status_history"."matched_conditions" IS 'JSON array of conditions that triggered this status (for conditional type)'`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "condition_rule_name"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "condition_rule_name" character varying(200)`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "status_type"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "status_type" character varying(50) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "new_status"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "new_status" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "old_status"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD "old_status" character varying(100)`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."release_date" IS 'Production/release date synced from schedule_data during work order creation'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."oee_goal" IS 'OEE goal that was active when this WO was completed'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."quality_goal" IS 'Quality goal that was active when this WO was completed'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."performance_goal" IS 'Performance goal that was active when this WO was completed'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."availability_goal" IS 'Availability goal that was active when this WO was completed (for historical comparison)'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."status_updated_by" IS 'User who last updated the status'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."status_updated_at" IS 'Timestamp when status was last updated'`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "status_updated_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."current_status" IS 'Current status: Waiting, Running, Ongoing, or Completed'`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "current_status" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."lead_hand_comment" IS 'Lead hand review and sign-off notes'`);
        await queryRunner.query(`COMMENT ON COLUMN "work_orders"."operator_comment" IS 'Operator notes and observations during production'`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "break_time" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "down_time" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "manual_run" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "qty_rejected" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "qty_completed" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "setup_time" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_orders" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "stripe_customer_id"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "stripe_customer_id" text`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "subscription_cancel_at_period_end" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "onboarding_completed" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "language"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "language" character varying(5) DEFAULT 'en'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "time_format"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "time_format" character varying(10) DEFAULT '12h'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "date_format"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "date_format" character varying(20) DEFAULT 'MM/DD/YYYY'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "currency"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "currency" character varying(3) DEFAULT 'USD'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "state_province"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "state_province" character varying(100)`);
        await queryRunner.query(`COMMENT ON COLUMN "companies"."plan_type" IS 'Subscription plan: free, pro, or enterprise'`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "plan_type" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "subscription_status" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "timezone" SET DEFAULT 'UTC'`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "timezone" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "country"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "country" text DEFAULT 'USA'`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "city"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "city" text`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "industry"`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "industry" text`);
        await queryRunner.query(`COMMENT ON COLUMN "companies"."slug" IS 'URL-friendly identifier for subdomain routing'`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_files"."is_active" IS 'Only one schedule file should be active per company at a time'`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "publish_to_schedule_page" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "auto_sync_enabled" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_files"."sync_frequency" IS 'How often to sync: realtime, every_15min, hourly, daily, manual'`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "sync_frequency" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_files"."source_type" IS 'Where the schedule is stored: database, file_system, cloud_storage, api'`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "source_type" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "is_synced" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "raw_data" SET DEFAULT '{}'`);
        await queryRunner.query(`COMMENT ON COLUMN "schedule_data"."raw_data" IS 'Original Excel row data as imported, unchanged.'`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."category" IS 'Category grouping: general, oee, schedule, etc.'`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."config_type" IS 'Data type: string, number, boolean, json'`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "config_type" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."config_value" IS 'Value of the configuration setting'`);
        await queryRunner.query(`COMMENT ON COLUMN "system_configurations"."config_key" IS 'Unique key for the configuration setting (e.g., oee.target_availability)'`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "display_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "requires_scrap" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "requires_rework" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD "department_id" integer`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "display_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "requires_approval" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "requires_comment" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "requires_photo" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP COLUMN "department_id"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD "department_id" integer`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "qc_rejections"."attributes" IS 'Flexible JSON field for company-specific custom attributes'`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "attributes" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "customer_complaint_related" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "equipment_id"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "equipment_id" integer`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "process_step_id"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD "process_step_id" integer`);
        await queryRunner.query(`COMMENT ON COLUMN "qc_rejections"."root_cause_category" IS '4M Analysis: Material, Method, Machine, Man (Operator)'`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "cost_currency" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "qc_rejections"."severity" IS 'Severity: critical (safety/unusable), major (functional issue), minor (cosmetic), observation (note for improvement)'`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "severity" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "inspection_date" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "display_order" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "requires_approval" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "can_edit_wo" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "is_terminal" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "is_default" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "user_profiles"."preferences" IS 'User preferences stored as JSONB. Structure: { "schedule": { "visibleColumns": [...], "columnOrder": [...] }, ... }'`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "shift_preference"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "shift_preference" character varying(20)`);
        await queryRunner.query(`COMMENT ON COLUMN "user_profiles"."permissions" IS 'JSON array of permission strings'`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "role" SET DEFAULT 'operator'`);
        await queryRunner.query(`COMMENT ON COLUMN "user_profiles"."role" IS 'User role: global_admin (all orgs), company_admin (their company), location_manager (their location), operator (production), viewer (read-only)'`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "employee_id"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "employee_id" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "display_name"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "display_name" character varying(200)`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "company_id" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ALTER COLUMN "id" DROP DEFAULT`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_operators"."assigned_at" IS 'When the operator was assigned to this work order'`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "assigned_at" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "work_order_operators"."is_primary" IS 'Indicates the primary/lead operator for the work order (first operator selected)'`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "is_primary" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "is_approved" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "qty_rejected" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "qty_produced" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "segment_type" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "time_segments"."start_time" IS 'Actual start time when work began. NULL for scheduled segments that have not started yet.'`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "start_time" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "time_segments"."operator_id" IS 'Operator who worked on this segment. NULL for scheduled segments not yet started'`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "operator_id" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "work_order_id" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "is_active" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "country"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "country" character varying(2)`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "production_lines" DROP NOT NULL`);
        await queryRunner.query(`COMMENT ON COLUMN "locations"."operating_hours" IS 'JSON object with daily operating hours'`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "manager_email"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "manager_email" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "manager_name"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "manager_name" character varying(255)`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "location_type"`);
        await queryRunner.query(`ALTER TABLE "locations" ADD "location_type" character varying(50) DEFAULT 'manufacturing'`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "updated_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "locations" ALTER COLUMN "created_at" DROP NOT NULL`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_templates" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" DROP COLUMN "created_at"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "company_id"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "custom_message"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "full_name"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "invitations" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "location_departments" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "location_statuses" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP COLUMN "parentCategoryId"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "product_categories" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP COLUMN "productId"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "product_pricing" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "locationId"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "run_sequence2"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "run_sequence1"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "product_id"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP COLUMN "changedBy"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP COLUMN "productId"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP COLUMN "productId"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "product_vendors" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "process_steps" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "operators" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "operator_departments" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "shifts" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "departments" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "department_settings" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" DROP COLUMN "updated_at"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP COLUMN "statusUpdatedBy"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP COLUMN "statusId"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP COLUMN "locationId"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "work_orders" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "has_used_free_trial"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "max_locations"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "max_users"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "subscription_tier"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "companies" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "uploadedBy"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "schedule_files" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "syncedWorkOrderId"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "scheduleFileId"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "shift"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "rejected"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "insp_qty"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "prod_qty"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "bulk_lot"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "prod_date"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "qty_open"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "department"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "part_number"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "status"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "due_date"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "sequence"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "release_date"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "wo_number"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "schedule_data" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP COLUMN "updatedBy"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP COLUMN "createdBy"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "system_configurations" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP COLUMN "categoryId"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "dispositionApprovedBy"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "operatorId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "resolvedBy"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "inspectorId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "rejectionReasonId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "workOrderId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "locationId"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "password"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "avatar_url"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "roles"`);
        await queryRunner.query(`DROP TYPE "public"."user_profiles_roles_enum"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "is_verified"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP CONSTRAINT "UQ_user_profiles_email"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "email"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "location_id"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "user_profiles" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP COLUMN "operatorId"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP COLUMN "workOrderId"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "approvedBy"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "operatorAssId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "operatorId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "workOrderId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "companyId"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "downtime_reason_id"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "time_segments" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "email"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "description"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "created_by"`);
        await queryRunner.query(`ALTER TABLE "locations" DROP COLUMN "deleted_at"`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "updated_by" uuid`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "error_count" integer DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "validation_rules" jsonb`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "required_columns" jsonb`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "template_id" uuid`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "source_type" character varying(50) DEFAULT 'excel'`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD "description" text`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "user_id" uuid`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD "organization_id" uuid`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "category_level_4" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "category_level_3" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "category_level_2" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "category_level_1" character varying(100)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "cycle_time_uom" character varying(20) DEFAULT 'seconds'`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "run_sequence_2" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "run_sequence_1" character varying(50)`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD "part_number" character varying(100) NOT NULL`);
        await queryRunner.query(`ALTER TABLE "companies" ADD "zip_code" character varying(20)`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "automatic_backups" boolean DEFAULT true`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "email_notifications" boolean DEFAULT true`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "next_retry_at" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "sync_retry_count" integer DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "last_sync_error" text`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "last_sync_status" character varying(20) DEFAULT 'pending'`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD "file_hash" character varying(64)`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD "data" jsonb NOT NULL DEFAULT '{}'`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "font_weight" character varying(20) DEFAULT 'normal'`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "status_type" character varying(20) DEFAULT 'custom'`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "flash_interval_ms" integer DEFAULT '1000'`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "is_flashing" boolean DEFAULT false`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "border_color" character varying(7)`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD "font_color" character varying(7) DEFAULT '#FFFFFF'`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD "default_location_id" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "step_oee" numeric(5,2) DEFAULT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "step_quality" numeric(5,2) DEFAULT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "step_performance" numeric(5,2) DEFAULT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "step_availability" numeric(5,2) DEFAULT NULL`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "step_config" jsonb`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "sch_time" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "status" character varying(50) DEFAULT 'running'`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "schedule_data_id" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "scheduled_date" TIMESTAMP WITH TIME ZONE`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "scheduled_by" uuid`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "schedule_notes" text`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "is_scheduled" boolean NOT NULL DEFAULT false`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD "process_step_id" integer`);
        await queryRunner.query(`DROP INDEX "public"."IDX_webhook_events_event_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_webhook_events_event_type"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_webhook_events_status"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_webhook_events_created_at"`);
        await queryRunner.query(`DROP TABLE "webhook_events"`);
        await queryRunner.query(`DROP TYPE "public"."webhook_events_status_enum"`);
        await queryRunner.query(`DROP TABLE "activity_log"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_transactions_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_transactions_subscription_id"`);
        await queryRunner.query(`DROP TABLE "transactions"`);
        await queryRunner.query(`DROP TYPE "public"."transactions_status_enum"`);
        await queryRunner.query(`DROP TYPE "public"."transactions_type_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_subscriptions_company_id"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_subscriptions_status"`);
        await queryRunner.query(`DROP TABLE "subscriptions"`);
        await queryRunner.query(`DROP TYPE "public"."subscriptions_billing_cycle_enum"`);
        await queryRunner.query(`DROP TYPE "public"."subscriptions_status_enum"`);
        await queryRunner.query(`DROP INDEX "public"."IDX_plans_code"`);
        await queryRunner.query(`DROP TABLE "plans"`);
        await queryRunner.query(`COMMENT ON TABLE "column_mapping_templates" IS 'Predefined column mapping templates for common ERP systems'`);
        await queryRunner.query(`COMMENT ON TABLE "column_mapping_history" IS 'Audit trail of mapping usage and modifications'`);
        await queryRunner.query(`COMMENT ON TABLE "company_column_mappings" IS 'Company-specific column mappings for flexible Excel/ERP integration'`);
        await queryRunner.query(`COMMENT ON TABLE "conditional_status_rules" IS 'Rules for automatic work order status assignment based on data conditions'`);
        await queryRunner.query(`COMMENT ON TABLE "department_oee_settings" IS 'Historical tracking of OEE goals and QC requirements per department. Supports time-based reporting by storing effective dates.'`);
        await queryRunner.query(`COMMENT ON TABLE "invitations" IS 'Tracks email invitations for organization admins and users'`);
        await queryRunner.query(`COMMENT ON TABLE "email_verification_tokens" IS 'Stores custom email verification tokens for user signup confirmation'`);
        await queryRunner.query(`COMMENT ON TABLE "location_departments" IS 'Junction table controlling which departments are visible at each location. Enables company-wide department definitions with location-specific visibility.'`);
        await queryRunner.query(`COMMENT ON TABLE "location_statuses" IS 'Junction table controlling which work order statuses are visible at each location. Enables company-wide status definitions with location-specific visibility.'`);
        await queryRunner.query(`COMMENT ON TABLE "operator_sessions" IS 'Active operator login sessions with 8-hour expiry'`);
        await queryRunner.query(`COMMENT ON TABLE "schedule_api_keys" IS 'API keys for sync agent authentication'`);
        await queryRunner.query(`COMMENT ON TABLE "operators" IS 'Production operators with employment and contact details'`);
        await queryRunner.query(`COMMENT ON TABLE "operator_departments" IS 'Many-to-many relationship between operators and departments'`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_downtime" IS 'Tracks all downtime events for work orders with duration and reasons. One work order can have multiple downtime records.'`);
        await queryRunner.query(`COMMENT ON TABLE "downtime_reasons" IS 'Specific reasons for downtime events. Each company has their own reasons organized by categories.'`);
        await queryRunner.query(`COMMENT ON TABLE "downtime_categories" IS 'Categories for organizing downtime reasons. Each company has their own categories.'`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_custom_statuses" IS 'Custom/dynamic statuses that users can create for work orders'`);
        await queryRunner.query(`COMMENT ON TABLE "departments" IS 'Department lookup table - stores department names and metadata'`);
        await queryRunner.query(`COMMENT ON TABLE "department_settings" IS 'Dynamic department filter configurations - defines how departments filter data'`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_status_history" IS 'Complete audit trail of all work order status changes'`);
        await queryRunner.query(`COMMENT ON TABLE "companies" IS 'Multi-tenant company/organization table'`);
        await queryRunner.query(`COMMENT ON TABLE "schedule_files" IS 'Stores references to schedule files and their sync settings'`);
        await queryRunner.query(`COMMENT ON TABLE "schedule_data" IS 'Stores imported schedule data from Excel files using JSONB for full flexibility. All Excel columns are stored in the data field. Column mapping determines what goes where. Acts as a staging table that syncs with work_orders.'`);
        await queryRunner.query(`COMMENT ON TABLE "system_configurations" IS 'Stores system-wide configuration settings per company'`);
        await queryRunner.query(`COMMENT ON TABLE "user_profiles" IS 'Extended user information linked to Supabase auth'`);
        await queryRunner.query(`COMMENT ON TABLE "work_order_operators" IS 'Junction table tracking which operators work on each work order - prevents duplicate counting in summations'`);
        await queryRunner.query(`COMMENT ON TABLE "locations" IS 'Manufacturing facilities and sites per company'`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD CONSTRAINT "unique_company_mapping_name" UNIQUE ("company_id", "mapping_name")`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "invitations_email_key" UNIQUE ("email", "organization_id", "status")`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "unique_location_department" UNIQUE ("location_id", "department_id")`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "unique_location_status" UNIQUE ("location_id", "status_id")`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD CONSTRAINT "unique_company_category" UNIQUE ("company_id", "category_name")`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "unique_company_part_number" UNIQUE ("company_id", "part_number")`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "unique_company_product_id" UNIQUE ("company_id", "part_number")`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD CONSTRAINT "unique_product_vendor" UNIQUE ("product_id", "vendor_id")`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "unique_company_dept_step_sequence" UNIQUE ("company_id", "department_id", "sequence")`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "unique_company_operator_id" UNIQUE ("company_id", "operator_id")`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD CONSTRAINT "unique_operator_department" UNIQUE ("operator_id", "department_id")`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "downtime_categories_company_name_unique" UNIQUE ("company_id", "name")`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "downtime_categories_company_id_name_key" UNIQUE ("company_id", "name")`);
        await queryRunner.query(`ALTER TABLE "departments" ADD CONSTRAINT "unique_company_department_name" UNIQUE ("company_id", "department_name")`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "unique_company_wo_number" UNIQUE ("company_id", "wo_number")`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "unique_company_wo_id" UNIQUE ("company_id", "wo_id")`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "unique_company_config_key" UNIQUE ("company_id", "config_key")`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "unique_work_order_operator" UNIQUE ("work_order_id", "operator_id")`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "unique_company_location_code" UNIQUE ("company_id", "code")`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "department_oee_settings_department_id_daterange_excl" EXCLUDE USING gist (department_id WITH =, daterange(effective_from, COALESCE(effective_to, '9999-12-31'::date), '[]'::text) WITH &&)`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "valid_priority" CHECK (((priority >= 0) AND (priority <= 1000)))`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "status_name_not_empty" CHECK ((TRIM(BOTH FROM status_name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "rule_name_not_empty" CHECK ((TRIM(BOTH FROM rule_name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "valid_date_range" CHECK (((effective_to IS NULL) OR (effective_to >= effective_from)))`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "valid_oee_goal" CHECK (((oee_goal >= (0)::numeric) AND (oee_goal <= (100)::numeric)))`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "valid_quality_goal" CHECK (((quality_goal >= (0)::numeric) AND (quality_goal <= (100)::numeric)))`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "valid_performance_goal" CHECK (((performance_goal >= (0)::numeric) AND (performance_goal <= (100)::numeric)))`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "valid_availability_goal" CHECK (((availability_goal >= (0)::numeric) AND (availability_goal <= (100)::numeric)))`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ADD CONSTRAINT "organization_invitations_status_check" CHECK ((status = ANY (ARRAY['pending'::text, 'accepted'::text, 'expired'::text])))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_percentages" CHECK (((scrap_percentage >= (0)::numeric) AND (scrap_percentage <= (100)::numeric) AND ((yield_percentage >= (0)::numeric) AND (yield_percentage <= (100)::numeric))))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_lead_time_positive" CHECK ((lead_time_days >= 0))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_weight_positive" CHECK (((weight IS NULL) OR (weight > (0)::numeric)))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_dimensions_positive" CHECK ((((length IS NULL) OR (length > (0)::numeric)) AND ((width IS NULL) OR (width > (0)::numeric)) AND ((height IS NULL) OR (height > (0)::numeric))))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_costs_positive" CHECK (((standard_cost >= (0)::numeric) AND ((last_cost IS NULL) OR (last_cost >= (0)::numeric)) AND ((average_cost IS NULL) OR (average_cost >= (0)::numeric))))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_inspection_type" CHECK ((((inspection_type)::text = ANY ((ARRAY['none'::character varying, 'first_piece'::character varying, 'sample'::character varying, 'full'::character varying, 'statistical'::character varying])::text[])) OR (inspection_type IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_assembly_type" CHECK ((((assembly_type)::text = ANY ((ARRAY['discrete'::character varying, 'batch'::character varying, 'continuous'::character varying, 'process'::character varying])::text[])) OR (assembly_type IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_lifecycle_status" CHECK (((lifecycle_status)::text = ANY ((ARRAY['design'::character varying, 'prototype'::character varying, 'active'::character varying, 'mature'::character varying, 'phase_out'::character varying, 'obsolete'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_abc_classification" CHECK (((abc_classification = ANY (ARRAY['A'::bpchar, 'B'::bpchar, 'C'::bpchar, 'D'::bpchar])) OR (abc_classification IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_make_or_buy" CHECK (((make_or_buy)::text = ANY ((ARRAY['make'::character varying, 'buy'::character varying, 'both'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_valuation_method" CHECK (((valuation_method)::text = ANY ((ARRAY['fifo'::character varying, 'lifo'::character varying, 'average'::character varying, 'standard'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "product_id_not_empty" CHECK ((TRIM(BOTH FROM part_number) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "check_inventory_type" CHECK (((inventory_type)::text = ANY ((ARRAY['raw_material'::character varying, 'finished_good'::character varying, 'work_in_progress'::character varying, 'assembly'::character varying, 'component'::character varying, 'tool'::character varying, 'consumable'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "check_step_type_values" CHECK (((step_type)::text = ANY ((ARRAY['required'::character varying, 'optional'::character varying, 'auto'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "valid_email" CHECK ((((email)::text ~ '^[^@]+@[^@]+\.[^@]+$'::text) OR (email IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "valid_status" CHECK (((status)::text = ANY ((ARRAY['active'::character varying, 'inactive'::character varying, 'on-leave'::character varying, 'terminated'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "valid_shift" CHECK ((((shift)::text = ANY ((ARRAY['day'::character varying, 'night'::character varying, 'rotating'::character varying, 'flexible'::character varying])::text[])) OR (shift IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "valid_employee_type" CHECK ((((employee_type)::text = ANY ((ARRAY['full-time'::character varying, 'part-time'::character varying, 'contractor'::character varying, 'temporary'::character varying])::text[])) OR (employee_type IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "name_not_empty" CHECK ((TRIM(BOTH FROM name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "departments" ADD CONSTRAINT "department_name_not_empty" CHECK ((TRIM(BOTH FROM department_name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "valid_status_type" CHECK (((status_type)::text = ANY ((ARRAY['system'::character varying, 'stamped'::character varying, 'conditional'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "break_time_valid" CHECK ((break_time >= 0))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "down_time_valid" CHECK ((down_time >= 0))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "setup_time_valid" CHECK ((setup_time >= 0))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "qty_rejected_valid" CHECK ((qty_rejected >= 0))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "qty_completed_valid" CHECK ((qty_completed >= 0))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "wo_qty_positive" CHECK ((wo_qty > 0))`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "wo_number_not_empty" CHECK ((TRIM(BOTH FROM wo_number) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "valid_time_format" CHECK (((time_format)::text = ANY ((ARRAY['12h'::character varying, '24h'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "valid_currency" CHECK (((currency)::text ~ '^[A-Z]{3}$'::text))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "valid_subscription_status" CHECK (((subscription_status)::text = ANY ((ARRAY['active'::character varying, 'inactive'::character varying, 'trial'::character varying, 'cancelled'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "valid_plan_type" CHECK (((plan_type)::text = ANY ((ARRAY['free'::character varying, 'pro'::character varying, 'enterprise'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "name_not_empty" CHECK ((TRIM(BOTH FROM name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "slug_length" CHECK (((length((slug)::text) >= 2) AND (length((slug)::text) <= 50)))`);
        await queryRunner.query(`ALTER TABLE "companies" ADD CONSTRAINT "valid_slug" CHECK (((slug)::text ~ '^[a-z0-9-]+$'::text))`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD CONSTRAINT "schedule_files_last_sync_status_check" CHECK (((last_sync_status)::text = ANY ((ARRAY['pending'::character varying, 'syncing'::character varying, 'success'::character varying, 'failed'::character varying, 'retrying'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD CONSTRAINT "code_not_empty" CHECK ((TRIM(BOTH FROM code) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD CONSTRAINT "name_not_empty" CHECK ((TRIM(BOTH FROM name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "valid_default_action" CHECK ((((default_action)::text = ANY ((ARRAY['rework'::character varying, 'scrap'::character varying, 'hold'::character varying, 'use_as_is'::character varying])::text[])) OR (default_action IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "code_not_empty" CHECK ((TRIM(BOTH FROM code) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "name_not_empty" CHECK ((TRIM(BOTH FROM name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_severity_check" CHECK (((severity)::text = ANY ((ARRAY['critical'::character varying, 'major'::character varying, 'minor'::character varying, 'observation'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "valid_action_taken" CHECK ((((action_taken)::text = ANY ((ARRAY['rework'::character varying, 'scrap'::character varying, 'hold'::character varying, 'use_as_is'::character varying])::text[])) OR (action_taken IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "quantity_rejected_positive" CHECK ((quantity_rejected > 0))`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD CONSTRAINT "code_not_empty" CHECK ((TRIM(BOTH FROM code) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD CONSTRAINT "name_not_empty" CHECK ((TRIM(BOTH FROM name) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "valid_role" CHECK (((role)::text = ANY ((ARRAY['global_admin'::character varying, 'company_admin'::character varying, 'location_manager'::character varying, 'operator'::character varying, 'viewer'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "valid_shift" CHECK ((((shift_preference)::text = ANY ((ARRAY['day'::character varying, 'night'::character varying, 'rotating'::character varying, 'flexible'::character varying])::text[])) OR (shift_preference IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "employee_id_not_empty" CHECK (((TRIM(BOTH FROM employee_id) <> ''::text) OR (employee_id IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "at_least_one_primary_per_wo" CHECK ((is_primary = ANY (ARRAY[true, false])))`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "qty_rejected_valid" CHECK ((qty_rejected >= 0))`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "qty_produced_valid" CHECK ((qty_produced >= 0))`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "valid_segment_type" CHECK (((segment_type)::text = ANY ((ARRAY['productive'::character varying, 'setup'::character varying, 'downtime'::character varying, 'break'::character varying, 'inspection'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "end_after_start" CHECK (((end_time IS NULL) OR (end_time >= start_time)))`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "valid_country" CHECK (((length((country)::text) = 2) OR (country IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "valid_manager_email" CHECK ((((manager_email)::text ~ '^[^@]+@[^@]+\.[^@]+$'::text) OR (manager_email IS NULL)))`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "valid_location_type" CHECK (((location_type)::text = ANY ((ARRAY['manufacturing'::character varying, 'warehouse'::character varying, 'office'::character varying, 'distribution'::character varying])::text[])))`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "code_not_empty" CHECK ((TRIM(BOTH FROM code) <> ''::text))`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "name_not_empty" CHECK ((TRIM(BOTH FROM name) <> ''::text))`);
        await queryRunner.query(`CREATE INDEX "idx_column_mapping_templates_is_system" ON "column_mapping_templates" ("is_system_template") `);
        await queryRunner.query(`CREATE INDEX "idx_column_mapping_templates_erp_system" ON "column_mapping_templates" ("erp_system") `);
        await queryRunner.query(`CREATE INDEX "idx_column_mapping_history_performed_at" ON "column_mapping_history" ("performed_at") `);
        await queryRunner.query(`CREATE INDEX "idx_column_mapping_history_action" ON "column_mapping_history" ("action") `);
        await queryRunner.query(`CREATE INDEX "idx_column_mapping_history_mapping_id" ON "column_mapping_history" ("mapping_id") `);
        await queryRunner.query(`CREATE INDEX "idx_column_mapping_history_company_id" ON "column_mapping_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_company_column_mappings_template_id" ON "company_column_mappings" ("template_id") `);
        await queryRunner.query(`CREATE INDEX "idx_company_column_mappings_is_default" ON "company_column_mappings" ("is_default") `);
        await queryRunner.query(`CREATE INDEX "idx_company_column_mappings_is_active" ON "company_column_mappings" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_company_column_mappings_company_id" ON "company_column_mappings" ("company_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "idx_unique_rule_name_per_company" ON "conditional_status_rules" ("company_id", "rule_name") WHERE (is_active = true)`);
        await queryRunner.query(`CREATE INDEX "idx_conditional_rules_priority" ON "conditional_status_rules" ("company_id", "priority") WHERE (is_active = true)`);
        await queryRunner.query(`CREATE INDEX "idx_conditional_rules_active" ON "conditional_status_rules" ("is_active") WHERE (is_active = true)`);
        await queryRunner.query(`CREATE INDEX "idx_conditional_rules_status" ON "conditional_status_rules" ("status_id") `);
        await queryRunner.query(`CREATE INDEX "idx_conditional_rules_company" ON "conditional_status_rules" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_dept_oee_settings_active" ON "department_oee_settings" ("department_id", "effective_from", "effective_to") WHERE (effective_to IS NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_dept_oee_settings_effective_to" ON "department_oee_settings" ("effective_to") `);
        await queryRunner.query(`CREATE INDEX "idx_dept_oee_settings_effective_from" ON "department_oee_settings" ("effective_from") `);
        await queryRunner.query(`CREATE INDEX "idx_dept_oee_settings_department" ON "department_oee_settings" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_dept_oee_settings_company" ON "department_oee_settings" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_invitations_expires_at" ON "invitations" ("expires_at") `);
        await queryRunner.query(`CREATE INDEX "idx_invitations_organization" ON "invitations" ("organization_id") `);
        await queryRunner.query(`CREATE INDEX "idx_invitations_status" ON "invitations" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_invitations_location_id" ON "invitations" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "idx_email_verification_tokens_expires_at" ON "email_verification_tokens" ("expires_at") `);
        await queryRunner.query(`CREATE INDEX "idx_email_verification_tokens_user_id" ON "email_verification_tokens" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "idx_email_verification_tokens_token" ON "email_verification_tokens" ("token") `);
        await queryRunner.query(`CREATE INDEX "idx_location_departments_sort" ON "location_departments" ("location_id", "sort_order") `);
        await queryRunner.query(`CREATE INDEX "idx_location_departments_visible" ON "location_departments" ("is_visible", "location_id") WHERE (is_visible = true)`);
        await queryRunner.query(`CREATE INDEX "idx_location_departments_department" ON "location_departments" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_location_departments_location" ON "location_departments" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "idx_location_statuses_sort" ON "location_statuses" ("location_id", "sort_order") `);
        await queryRunner.query(`CREATE INDEX "idx_location_statuses_visible" ON "location_statuses" ("is_visible", "location_id") WHERE (is_visible = true)`);
        await queryRunner.query(`CREATE INDEX "idx_location_statuses_status" ON "location_statuses" ("status_id") `);
        await queryRunner.query(`CREATE INDEX "idx_location_statuses_location" ON "location_statuses" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "idx_org_invitations_status" ON "organization_invitations" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_org_invitations_email" ON "organization_invitations" ("email") `);
        await queryRunner.query(`CREATE INDEX "idx_org_invitations_token" ON "organization_invitations" ("token") `);
        await queryRunner.query(`CREATE INDEX "idx_operator_sessions_expires_at" ON "operator_sessions" ("expires_at") `);
        await queryRunner.query(`CREATE INDEX "idx_operator_sessions_token_hash" ON "operator_sessions" ("token_hash") `);
        await queryRunner.query(`CREATE INDEX "idx_operator_sessions_operator_id" ON "operator_sessions" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_categories_parent" ON "product_categories" ("parent_category_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_categories_company" ON "product_categories" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_pricing_active" ON "product_pricing" ("effective_end_date", "effective_start_date", "is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_product_pricing_tier" ON "product_pricing" ("price_tier") `);
        await queryRunner.query(`CREATE INDEX "idx_product_pricing_product" ON "product_pricing" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_category_hierarchy" ON "partnumber_info" ("category_level_1", "category_level_2", "category_level_3", "company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_category_level_4" ON "partnumber_info" ("category_level_4") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_category_level_3" ON "partnumber_info" ("category_level_3") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_category_level_2" ON "partnumber_info" ("category_level_2") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_category_level_1" ON "partnumber_info" ("category_level_1") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_info_part_number" ON "partnumber_info" ("part_number") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_company_type" ON "partnumber_info" ("company_id", "inventory_type") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_company_category" ON "partnumber_info" ("company_id", "product_category") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_company_lifecycle" ON "partnumber_info" ("company_id", "lifecycle_status") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_tags_gin" ON "partnumber_info" ("tags") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_custom_fields_gin" ON "partnumber_info" ("custom_fields") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_metadata_gin" ON "partnumber_info" ("metadata") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_sellable" ON "partnumber_info" ("sellable") WHERE (sellable = true)`);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_purchasable" ON "partnumber_info" ("purchasable") WHERE (purchasable = true)`);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_hazmat" ON "partnumber_info" ("hazmat") WHERE (hazmat = true)`);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_requires_inspection" ON "partnumber_info" ("requires_inspection") WHERE (requires_inspection = true)`);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_critical_item" ON "partnumber_info" ("critical_item") WHERE (critical_item = true)`);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_make_or_buy" ON "partnumber_info" ("make_or_buy") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_product_category" ON "partnumber_info" ("product_category") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_barcode" ON "partnumber_info" ("barcode") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_sku" ON "partnumber_info" ("sku") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_primary_vendor" ON "partnumber_info" ("primary_vendor_id") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_abc_classification" ON "partnumber_info" ("abc_classification") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_lifecycle_status" ON "partnumber_info" ("lifecycle_status") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_inventory_type" ON "partnumber_info" ("inventory_type") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_info_is_active" ON "partnumber_info" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_info_department" ON "partnumber_info" ("department") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_info_location_id" ON "partnumber_info" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "idx_partnumber_info_company_id" ON "partnumber_info" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_cost_history_company" ON "product_cost_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_cost_history_product" ON "product_cost_history" ("effective_date", "product_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_vendors_primary" ON "product_vendors" ("is_primary") WHERE (is_primary = true)`);
        await queryRunner.query(`CREATE INDEX "idx_product_vendors_product" ON "product_vendors" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "idx_product_vendors_company" ON "product_vendors" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_api_keys_company" ON "schedule_api_keys" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_api_keys_api_key" ON "schedule_api_keys" ("api_key") `);
        await queryRunner.query(`CREATE INDEX "idx_soa_status" ON "schedule_operator_assignments" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_soa_company" ON "schedule_operator_assignments" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_soa_operator" ON "schedule_operator_assignments" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_soa_schedule_data" ON "schedule_operator_assignments" ("schedule_data_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_operator_assignments_scheduled_time" ON "schedule_operator_assignments" ("scheduled_start_time") `);
        await queryRunner.query(`CREATE INDEX "idx_process_steps_attributes" ON "process_steps" ("attributes") `);
        await queryRunner.query(`CREATE INDEX "idx_process_steps_company_dept_sequence" ON "process_steps" ("company_id", "department_id", "sequence") `);
        await queryRunner.query(`CREATE INDEX "idx_process_steps_is_active" ON "process_steps" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_process_steps_department_id" ON "process_steps" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_process_steps_company_id" ON "process_steps" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_operators_must_change_password" ON "operators" ("must_change_password") `);
        await queryRunner.query(`CREATE INDEX "idx_operators_password_hash" ON "operators" ("password_hash") WHERE (password_hash IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_operators_email" ON "operators" ("email") `);
        await queryRunner.query(`CREATE INDEX "idx_operators_operator_id" ON "operators" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_operators_status" ON "operators" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_operators_user_id" ON "operators" ("user_id") `);
        await queryRunner.query(`CREATE INDEX "idx_operators_company_id" ON "operators" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_operator_departments_is_primary" ON "operator_departments" ("is_primary") `);
        await queryRunner.query(`CREATE INDEX "idx_operator_departments_department_id" ON "operator_departments" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_operator_departments_operator_id" ON "operator_departments" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_shifts_active" ON "shifts" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_shifts_company" ON "shifts" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_downtime_reason" ON "work_order_downtime" ("downtime_reason_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_downtime_start_time" ON "work_order_downtime" ("start_time") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_downtime_work_order" ON "work_order_downtime" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_downtime_company" ON "work_order_downtime" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_reasons_active" ON "downtime_reasons" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_reasons_category" ON "downtime_reasons" ("category_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_reasons_company" ON "downtime_reasons" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_reasons_department_id" ON "downtime_reasons" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_reasons_company_id" ON "downtime_reasons" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_categories_company" ON "downtime_categories" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_categories_department_id" ON "downtime_categories" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_downtime_categories_company_id" ON "downtime_categories" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_custom_statuses_display_order" ON "work_order_custom_statuses" ("company_id", "display_order") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_custom_statuses_is_active" ON "work_order_custom_statuses" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_custom_statuses_department_id" ON "work_order_custom_statuses" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_custom_statuses_company_id" ON "work_order_custom_statuses" ("company_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "idx_unique_company_dept_status_name" ON "work_order_custom_statuses" ("company_id", "name") `);
        await queryRunner.query(`CREATE INDEX "idx_departments_department_name" ON "departments" ("department_name") `);
        await queryRunner.query(`CREATE INDEX "idx_departments_is_active" ON "departments" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_department_settings_department_name" ON "department_settings" ("department_name") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_status_history_rule" ON "work_order_status_history" ("condition_rule_id") WHERE (condition_rule_id IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_wo_status_history_status_type" ON "work_order_status_history" ("status_type") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_status_history_changed_at" ON "work_order_status_history" ("changed_at") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_status_history_company" ON "work_order_status_history" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_status_history_wo_id" ON "work_order_status_history" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_company_release_date" ON "work_orders" ("company_id", "release_date") WHERE (release_date IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_release_date" ON "work_orders" ("release_date") WHERE (release_date IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_company" ON "work_orders" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_current_status" ON "work_orders" ("current_status") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_closing_time" ON "work_orders" ("closing_time") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_start_time" ON "work_orders" ("start_time") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_product_id" ON "work_orders" ("product_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_wo_number" ON "work_orders" ("wo_number") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_status_id" ON "work_orders" ("status_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_department_id" ON "work_orders" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_location_id" ON "work_orders" ("location_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_orders_company_id" ON "work_orders" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_companies_trial_ends_at" ON "companies" ("trial_ends_at") WHERE (trial_ends_at IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_companies_subscription_status" ON "companies" ("subscription_status") `);
        await queryRunner.query(`CREATE INDEX "idx_companies_stripe_subscription_id" ON "companies" ("stripe_subscription_id") WHERE (stripe_subscription_id IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_companies_stripe_customer_id" ON "companies" ("stripe_customer_id") WHERE (stripe_customer_id IS NOT NULL)`);
        await queryRunner.query(`CREATE INDEX "idx_companies_is_active" ON "companies" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_companies_plan_type" ON "companies" ("plan_type") `);
        await queryRunner.query(`CREATE INDEX "idx_companies_slug" ON "companies" ("slug") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_sync_status" ON "schedule_files" ("last_sync_status") WHERE ((last_sync_status)::text = ANY ((ARRAY['failed'::character varying, 'retrying'::character varying])::text[]))`);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_auto_sync" ON "schedule_files" ("auto_sync_enabled", "next_retry_at", "sync_frequency") WHERE (auto_sync_enabled = true)`);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_next_retry_at" ON "schedule_files" ("next_retry_at") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_last_sync_status" ON "schedule_files" ("last_sync_status") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_file_name" ON "schedule_files" ("file_name") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_is_active" ON "schedule_files" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_files_company_id" ON "schedule_files" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_data_raw_data_gin" ON "schedule_data" ("raw_data") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_data_data_gin" ON "schedule_data" ("data") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_data_import_batch_id" ON "schedule_data" ("import_batch_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_data_schedule_file_id" ON "schedule_data" ("schedule_file_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_data_wo_id" ON "schedule_data" ("wo_id") `);
        await queryRunner.query(`CREATE INDEX "idx_schedule_data_company_id" ON "schedule_data" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_system_configurations_is_active" ON "system_configurations" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_system_configurations_category" ON "system_configurations" ("category") `);
        await queryRunner.query(`CREATE INDEX "idx_system_configurations_company_id" ON "system_configurations" ("company_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "unique_department_category_code_idx" ON "rejection_categories" ("code", "company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_categories_department_id" ON "rejection_categories" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_categories_is_active" ON "rejection_categories" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_categories_company_id" ON "rejection_categories" ("company_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "unique_department_reason_code_idx" ON "rejection_reasons" ("code", "company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_reasons_department_id" ON "rejection_reasons" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_reasons_is_active" ON "rejection_reasons" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_reasons_category_id" ON "rejection_reasons" ("category_id") `);
        await queryRunner.query(`CREATE INDEX "idx_rejection_reasons_company_id" ON "rejection_reasons" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_root_cause_category" ON "qc_rejections" ("root_cause_category") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_shift" ON "qc_rejections" ("shift") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_operator_id" ON "qc_rejections" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_process_step_id" ON "qc_rejections" ("process_step_id") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_severity" ON "qc_rejections" ("severity") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_inspection_date" ON "qc_rejections" ("inspection_date") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_rejection_reason_id" ON "qc_rejections" ("rejection_reason_id") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_work_order_id" ON "qc_rejections" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "idx_qc_rejections_company_id" ON "qc_rejections" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_statuses_is_active" ON "work_order_statuses" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_statuses_department_id" ON "work_order_statuses" ("department_id") `);
        await queryRunner.query(`CREATE INDEX "idx_wo_statuses_company_id" ON "work_order_statuses" ("company_id") `);
        await queryRunner.query(`CREATE UNIQUE INDEX "idx_unique_company_dept_status_code" ON "work_order_statuses" ("code", "company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_user_profiles_preferences" ON "user_profiles" ("preferences") `);
        await queryRunner.query(`CREATE INDEX "idx_user_profiles_is_active" ON "user_profiles" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_user_profiles_role" ON "user_profiles" ("role") `);
        await queryRunner.query(`CREATE INDEX "idx_user_profiles_company_id" ON "user_profiles" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_operators_primary" ON "work_order_operators" ("is_primary", "work_order_id") WHERE (is_primary = true)`);
        await queryRunner.query(`CREATE INDEX "idx_work_order_operators_company_id" ON "work_order_operators" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_operators_operator_id" ON "work_order_operators" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_work_order_operators_wo_id" ON "work_order_operators" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_scheduled_match" ON "time_segments" ("operator_id", "process_step_id", "status", "work_order_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_status" ON "time_segments" ("status") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_process_step" ON "time_segments" ("process_step_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_schedule_data" ON "time_segments" ("schedule_data_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_operator_scheduled" ON "time_segments" ("is_scheduled", "operator_id", "start_time") WHERE ((is_scheduled = true) AND (operator_id IS NOT NULL))`);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_scheduling" ON "time_segments" ("is_scheduled", "operator_id", "process_step_id", "work_order_id") WHERE (is_scheduled = true)`);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_sch_time" ON "time_segments" ("sch_time") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_process_step_id" ON "time_segments" ("process_step_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_is_active" ON "time_segments" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_shift_date" ON "time_segments" ("shift_date") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_start_time" ON "time_segments" ("start_time") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_operator_id" ON "time_segments" ("operator_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_work_order_id" ON "time_segments" ("work_order_id") `);
        await queryRunner.query(`CREATE INDEX "idx_time_segments_company_id" ON "time_segments" ("company_id") `);
        await queryRunner.query(`CREATE INDEX "idx_locations_is_active" ON "locations" ("is_active") `);
        await queryRunner.query(`CREATE INDEX "idx_locations_company_id" ON "locations" ("company_id") `);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD CONSTRAINT "column_mapping_history_performed_by_fkey" FOREIGN KEY ("performed_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD CONSTRAINT "column_mapping_history_mapping_id_fkey" FOREIGN KEY ("mapping_id") REFERENCES "company_column_mappings"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "column_mapping_history" ADD CONSTRAINT "column_mapping_history_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD CONSTRAINT "company_column_mappings_updated_by_fkey" FOREIGN KEY ("updated_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD CONSTRAINT "company_column_mappings_template_id_fkey" FOREIGN KEY ("template_id") REFERENCES "column_mapping_templates"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD CONSTRAINT "company_column_mappings_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "company_column_mappings" ADD CONSTRAINT "company_column_mappings_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "conditional_status_rules_status_id_fkey" FOREIGN KEY ("status_id") REFERENCES "work_order_statuses"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "conditional_status_rules_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "conditional_status_rules" ADD CONSTRAINT "conditional_status_rules_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "department_oee_settings_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "department_oee_settings_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_oee_settings" ADD CONSTRAINT "department_oee_settings_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "invitations_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "invitations_organization_id_fkey" FOREIGN KEY ("organization_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "invitations_location_id_fkey" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "invitations" ADD CONSTRAINT "invitations_invited_by_fkey" FOREIGN KEY ("invited_by") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "email_verification_tokens" ADD CONSTRAINT "email_verification_tokens_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "auth"."users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "location_departments_updated_by_fkey" FOREIGN KEY ("updated_by") REFERENCES "auth"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "location_departments_location_id_fkey" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "location_departments_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_departments" ADD CONSTRAINT "location_departments_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "auth"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "location_statuses_updated_by_fkey" FOREIGN KEY ("updated_by") REFERENCES "auth"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "location_statuses_status_id_fkey" FOREIGN KEY ("status_id") REFERENCES "work_order_statuses"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "location_statuses_location_id_fkey" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "location_statuses" ADD CONSTRAINT "location_statuses_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "auth"."users"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "organization_invitations" ADD CONSTRAINT "organization_invitations_created_organization_id_fkey" FOREIGN KEY ("created_organization_id") REFERENCES "companies"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD CONSTRAINT "operator_sessions_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_sessions" ADD CONSTRAINT "operator_sessions_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD CONSTRAINT "product_categories_parent_category_id_fkey" FOREIGN KEY ("parent_category_id") REFERENCES "product_categories"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_categories" ADD CONSTRAINT "product_categories_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD CONSTRAINT "product_pricing_product_id_fkey" FOREIGN KEY ("product_id") REFERENCES "partnumber_info"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_pricing" ADD CONSTRAINT "product_pricing_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "partnumber_info_location_id_fkey" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "partnumber_info" ADD CONSTRAINT "partnumber_info_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD CONSTRAINT "product_cost_history_product_id_fkey" FOREIGN KEY ("product_id") REFERENCES "partnumber_info"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD CONSTRAINT "product_cost_history_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_cost_history" ADD CONSTRAINT "product_cost_history_changed_by_fkey" FOREIGN KEY ("changed_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD CONSTRAINT "product_vendors_product_id_fkey" FOREIGN KEY ("product_id") REFERENCES "partnumber_info"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "product_vendors" ADD CONSTRAINT "product_vendors_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD CONSTRAINT "schedule_api_keys_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_api_keys" ADD CONSTRAINT "schedule_api_keys_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "schedule_operator_assignments_shift_id_fkey" FOREIGN KEY ("shift_id") REFERENCES "shifts"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "schedule_operator_assignments_schedule_data_id_fkey" FOREIGN KEY ("schedule_data_id") REFERENCES "schedule_data"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "schedule_operator_assignments_process_step_id_fkey" FOREIGN KEY ("process_step_id") REFERENCES "process_steps"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "schedule_operator_assignments_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "schedule_operator_assignments_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_operator_assignments" ADD CONSTRAINT "schedule_operator_assignments_assigned_by_fkey" FOREIGN KEY ("assigned_by") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "process_steps_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "process_steps" ADD CONSTRAINT "process_steps_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "operators_user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "auth"."users"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "operators_default_location_id_fkey" FOREIGN KEY ("default_location_id") REFERENCES "locations"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operators" ADD CONSTRAINT "operators_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD CONSTRAINT "operator_departments_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "operator_departments" ADD CONSTRAINT "operator_departments_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "shifts" ADD CONSTRAINT "shifts_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "work_order_downtime_work_order_id_fkey" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "work_order_downtime_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "work_order_downtime_downtime_reason_id_fkey" FOREIGN KEY ("downtime_reason_id") REFERENCES "downtime_reasons"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_downtime" ADD CONSTRAINT "work_order_downtime_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "downtime_reasons_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "downtime_reasons_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_reasons" ADD CONSTRAINT "downtime_reasons_category_id_fkey" FOREIGN KEY ("category_id") REFERENCES "downtime_categories"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "downtime_categories_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "downtime_categories" ADD CONSTRAINT "downtime_categories_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "work_order_custom_statuses_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "work_order_custom_statuses_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_custom_statuses" ADD CONSTRAINT "work_order_custom_statuses_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "departments" ADD CONSTRAINT "departments_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD CONSTRAINT "department_settings_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "department_settings" ADD CONSTRAINT "department_settings_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "work_order_status_history_work_order_id_fkey" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "work_order_status_history_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_status_history" ADD CONSTRAINT "work_order_status_history_changed_by_fkey" FOREIGN KEY ("changed_by") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "work_orders_status_updated_by_fkey" FOREIGN KEY ("status_updated_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "work_orders_status_id_fkey" FOREIGN KEY ("status_id") REFERENCES "work_order_statuses"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "work_orders_location_id_fkey" FOREIGN KEY ("location_id") REFERENCES "locations"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "work_orders_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_orders" ADD CONSTRAINT "fk_work_orders_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD CONSTRAINT "schedule_files_uploaded_by_fkey" FOREIGN KEY ("uploaded_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_files" ADD CONSTRAINT "schedule_files_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "schedule_data_synced_work_order_id_fkey" FOREIGN KEY ("synced_work_order_id") REFERENCES "work_orders"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "schedule_data_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "schedule_data" ADD CONSTRAINT "fk_schedule_data_schedule_file" FOREIGN KEY ("schedule_file_id") REFERENCES "schedule_files"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "system_configurations_updated_by_fkey" FOREIGN KEY ("updated_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "system_configurations_created_by_fkey" FOREIGN KEY ("created_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "system_configurations" ADD CONSTRAINT "system_configurations_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD CONSTRAINT "rejection_categories_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_categories" ADD CONSTRAINT "rejection_categories_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "rejection_reasons_department_id_fkey" FOREIGN KEY ("department_id") REFERENCES "departments"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "rejection_reasons_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "rejection_reasons" ADD CONSTRAINT "rejection_reasons_category_id_fkey" FOREIGN KEY ("category_id") REFERENCES "rejection_categories"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_work_order_id_fkey" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_resolved_by_fkey" FOREIGN KEY ("resolved_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_rejection_reason_id_fkey" FOREIGN KEY ("rejection_reason_id") REFERENCES "rejection_reasons"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_process_step_id_fkey" FOREIGN KEY ("process_step_id") REFERENCES "process_steps"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_inspector_id_fkey" FOREIGN KEY ("inspector_id") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_disposition_approved_by_fkey" FOREIGN KEY ("disposition_approved_by") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "qc_rejections" ADD CONSTRAINT "qc_rejections_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_statuses" ADD CONSTRAINT "work_order_statuses_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "user_profiles_id_fkey" FOREIGN KEY ("id") REFERENCES "auth"."users"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "user_profiles_default_location_id_fkey" FOREIGN KEY ("default_location_id") REFERENCES "locations"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "user_profiles_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "user_profiles" ADD CONSTRAINT "fk_user_profiles_company" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "work_order_operators_work_order_id_fkey" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "work_order_operators_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "user_profiles"("id") ON DELETE RESTRICT ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "work_order_operators" ADD CONSTRAINT "work_order_operators_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_work_order_id_fkey" FOREIGN KEY ("work_order_id") REFERENCES "work_orders"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_scheduled_by_fkey" FOREIGN KEY ("scheduled_by") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_schedule_data_id_fkey" FOREIGN KEY ("schedule_data_id") REFERENCES "schedule_data"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_process_step_id_fkey" FOREIGN KEY ("process_step_id") REFERENCES "process_steps"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_operator_id_fkey" FOREIGN KEY ("operator_id") REFERENCES "operators"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_operator_ass_id_fkey" FOREIGN KEY ("operator_ass_id") REFERENCES "user_profiles"("id") ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "time_segments" ADD CONSTRAINT "time_segments_approved_by_fkey" FOREIGN KEY ("approved_by") REFERENCES "user_profiles"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE "locations" ADD CONSTRAINT "locations_company_id_fkey" FOREIGN KEY ("company_id") REFERENCES "companies"("id") ON DELETE CASCADE ON UPDATE NO ACTION`);
    }

}
